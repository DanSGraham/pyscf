

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pyscf.dft.libxc &mdash; PySCF 1.5.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PySCF 1.5.0 documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> PySCF
          

          
          </a>

          
            
            
              <div class="version">
                1.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">1. An overview of PySCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">2. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">3. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gto.html">4. gto &#8212; Molecular structure and GTO basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../lib.html">5. <code class="docutils literal"><span class="pre">lib</span></code> &#8212; Helper functions, parameters, and C extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scf.html">6. scf &#8212; Mean-field methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ao2mo.html">7. ao2mo &#8212; Integral transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mcscf.html">8. mcscf &#8212; Multi-configurational self-consistent field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fci.html">9. fci &#8212; Full configuration interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../symm.html">10. symm &#8211; Point group symmetry and spin symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../df.html">11. df &#8212; Density fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dft.html">12. dft &#8212; Density functional theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tddft.html">13. tddft &#8212; Time dependent density functional theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cc.html">14. cc &#8212; Coupled cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ci.html">15. ci &#8212; Configuration interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dmrgscf.html">16. dmrgscf</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fciqmcscf.html">17. fciqmcscf</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tools.html">18. tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../grad.html">19. grad &#8212; Analytical nuclear gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hessian.html">20. hessian &#8212; Analytical nuclear Hessian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pbc.html">21. pbc &#8212; Periodic boundary conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nao.html">22. nao &#8212; Numerical Atomic Orbitals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../lo.html">23. lo &#8212; Orbital localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../advanced.html">24. Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../qmmm.html">25. qmmm &#8212; QM/MM interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mrpt.html">26. mrpt &#8212; Multi-reference perturbation theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../benchmark.html">27. Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code-rule.html">28. Code standard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../version.html">29. Version history</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">PySCF</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>pyscf.dft.libxc</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyscf.dft.libxc</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># Copyright 2014-2018 The PySCF Developers. All Rights Reserved.</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="c1">#</span>
<span class="c1"># Authors: Qiming Sun &lt;osirpt.sun@gmail.com&gt;</span>
<span class="c1">#          Susi Lehtola &lt;susi.lehtola@gmail.com&gt;</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">XC functional, the interface to libxc</span>
<span class="sd">(http://www.tddft.org/programs/octopus/wiki/index.php/Libxc)</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">ctypes</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">lib</span>

<span class="n">_itrf</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">load_library</span><span class="p">(</span><span class="s1">&#39;libxc_itrf&#39;</span><span class="p">)</span>
<span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_is_lda</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span>
<span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_is_gga</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span>
<span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_is_meta_gga</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span>
<span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_is_hybrid</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span>
<span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_max_deriv_order</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span>
<span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_hybrid_coeff</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">]</span>
<span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_hybrid_coeff</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span>
<span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_nlc_coeff</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">,</span><span class="n">ctypes</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">)]</span>
<span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_rsh_coeff</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">,</span><span class="n">ctypes</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">)]</span>

<span class="c1"># xc_code from libxc</span>
<span class="c1">#cat lib/deps/include/xc_funcs.h  | awk &#39;{printf(&quot;&#39;\&#39;&#39;%s&#39;\&#39;&#39; %3i&quot;,$2,$3); for(i=4;i&lt;NF;i++) {printf(&quot; %s&quot;,$i)}; printf(&quot;\n&quot;)}&#39;  | sed &quot;s|/\*|# |g&quot; | awk &#39;{printf(&quot;%-30s : %4i\,&quot;,$1,$2); for(i=4;i&lt;NF;i++) {printf(&quot; %s&quot;,$i)}; printf(&quot;\n&quot;)}&#39;</span>

<span class="n">XC</span> <span class="o">=</span> <span class="n">XC_CODES</span> <span class="o">=</span> <span class="p">{</span>
<span class="s1">&#39;XC_LDA_X&#39;</span>                     <span class="p">:</span>    <span class="mi">1</span><span class="p">,</span> <span class="c1"># Exchange</span>
<span class="s1">&#39;XC_LDA_C_WIGNER&#39;</span>              <span class="p">:</span>    <span class="mi">2</span><span class="p">,</span> <span class="c1"># Wigner parametrization</span>
<span class="s1">&#39;XC_LDA_C_RPA&#39;</span>                 <span class="p">:</span>    <span class="mi">3</span><span class="p">,</span> <span class="c1"># Random Phase Approximation</span>
<span class="s1">&#39;XC_LDA_C_HL&#39;</span>                  <span class="p">:</span>    <span class="mi">4</span><span class="p">,</span> <span class="c1"># Hedin &amp; Lundqvist</span>
<span class="s1">&#39;XC_LDA_C_GL&#39;</span>                  <span class="p">:</span>    <span class="mi">5</span><span class="p">,</span> <span class="c1"># Gunnarson &amp; Lundqvist</span>
<span class="s1">&#39;XC_LDA_C_XALPHA&#39;</span>              <span class="p">:</span>    <span class="mi">6</span><span class="p">,</span> <span class="c1"># Slater Xalpha</span>
<span class="s1">&#39;XC_LDA_C_VWN&#39;</span>                 <span class="p">:</span>    <span class="mi">7</span><span class="p">,</span> <span class="c1"># Vosko, Wilk, &amp; Nusair (5)</span>
<span class="s1">&#39;XC_LDA_C_VWN_RPA&#39;</span>             <span class="p">:</span>    <span class="mi">8</span><span class="p">,</span> <span class="c1"># Vosko, Wilk, &amp; Nusair (RPA)</span>
<span class="s1">&#39;XC_LDA_C_PZ&#39;</span>                  <span class="p">:</span>    <span class="mi">9</span><span class="p">,</span> <span class="c1"># Perdew &amp; Zunger</span>
<span class="s1">&#39;XC_LDA_C_PZ_MOD&#39;</span>              <span class="p">:</span>   <span class="mi">10</span><span class="p">,</span> <span class="c1"># Perdew &amp; Zunger (Modified)</span>
<span class="s1">&#39;XC_LDA_C_OB_PZ&#39;</span>               <span class="p">:</span>   <span class="mi">11</span><span class="p">,</span> <span class="c1"># Ortiz &amp; Ballone (PZ)</span>
<span class="s1">&#39;XC_LDA_C_PW&#39;</span>                  <span class="p">:</span>   <span class="mi">12</span><span class="p">,</span> <span class="c1"># Perdew &amp; Wang</span>
<span class="s1">&#39;XC_LDA_C_PW_MOD&#39;</span>              <span class="p">:</span>   <span class="mi">13</span><span class="p">,</span> <span class="c1"># Perdew &amp; Wang (Modified)</span>
<span class="s1">&#39;XC_LDA_C_OB_PW&#39;</span>               <span class="p">:</span>   <span class="mi">14</span><span class="p">,</span> <span class="c1"># Ortiz &amp; Ballone (PW)</span>
<span class="s1">&#39;XC_LDA_C_2D_AMGB&#39;</span>             <span class="p">:</span>   <span class="mi">15</span><span class="p">,</span> <span class="c1"># Attaccalite et al</span>
<span class="s1">&#39;XC_LDA_C_2D_PRM&#39;</span>              <span class="p">:</span>   <span class="mi">16</span><span class="p">,</span> <span class="c1"># Pittalis, Rasanen &amp; Marques correlation in 2D</span>
<span class="s1">&#39;XC_LDA_C_VBH&#39;</span>                 <span class="p">:</span>   <span class="mi">17</span><span class="p">,</span> <span class="c1"># von Barth &amp; Hedin</span>
<span class="s1">&#39;XC_LDA_C_1D_CSC&#39;</span>              <span class="p">:</span>   <span class="mi">18</span><span class="p">,</span> <span class="c1"># Casula, Sorella, and Senatore 1D correlation</span>
<span class="s1">&#39;XC_LDA_X_2D&#39;</span>                  <span class="p">:</span>   <span class="mi">19</span><span class="p">,</span> <span class="c1"># Exchange in 2D</span>
<span class="s1">&#39;XC_LDA_XC_TETER93&#39;</span>            <span class="p">:</span>   <span class="mi">20</span><span class="p">,</span> <span class="c1"># Teter 93 parametrization</span>
<span class="s1">&#39;XC_LDA_X_1D&#39;</span>                  <span class="p">:</span>   <span class="mi">21</span><span class="p">,</span> <span class="c1"># Exchange in 1D</span>
<span class="s1">&#39;XC_LDA_C_ML1&#39;</span>                 <span class="p">:</span>   <span class="mi">22</span><span class="p">,</span> <span class="c1"># Modified LSD (version 1) of Proynov and Salahub</span>
<span class="s1">&#39;XC_LDA_C_ML2&#39;</span>                 <span class="p">:</span>   <span class="mi">23</span><span class="p">,</span> <span class="c1"># Modified LSD (version 2) of Proynov and Salahub</span>
<span class="s1">&#39;XC_LDA_C_GOMBAS&#39;</span>              <span class="p">:</span>   <span class="mi">24</span><span class="p">,</span> <span class="c1"># Gombas parametrization</span>
<span class="s1">&#39;XC_LDA_C_PW_RPA&#39;</span>              <span class="p">:</span>   <span class="mi">25</span><span class="p">,</span> <span class="c1"># Perdew &amp; Wang fit of the RPA</span>
<span class="s1">&#39;XC_LDA_C_1D_LOOS&#39;</span>             <span class="p">:</span>   <span class="mi">26</span><span class="p">,</span> <span class="c1"># P-F Loos correlation LDA</span>
<span class="s1">&#39;XC_LDA_C_RC04&#39;</span>                <span class="p">:</span>   <span class="mi">27</span><span class="p">,</span> <span class="c1"># Ragot-Cortona</span>
<span class="s1">&#39;XC_LDA_C_VWN_1&#39;</span>               <span class="p">:</span>   <span class="mi">28</span><span class="p">,</span> <span class="c1"># Vosko, Wilk, &amp; Nusair (1)</span>
<span class="s1">&#39;XC_LDA_C_VWN_2&#39;</span>               <span class="p">:</span>   <span class="mi">29</span><span class="p">,</span> <span class="c1"># Vosko, Wilk, &amp; Nusair (2)</span>
<span class="s1">&#39;XC_LDA_C_VWN_3&#39;</span>               <span class="p">:</span>   <span class="mi">30</span><span class="p">,</span> <span class="c1"># Vosko, Wilk, &amp; Nusair (3)</span>
<span class="s1">&#39;XC_LDA_C_VWN_4&#39;</span>               <span class="p">:</span>   <span class="mi">31</span><span class="p">,</span> <span class="c1"># Vosko, Wilk, &amp; Nusair (4)</span>
<span class="s1">&#39;XC_LDA_XC_ZLP&#39;</span>                <span class="p">:</span>   <span class="mi">43</span><span class="p">,</span> <span class="c1"># Zhao, Levy &amp; Parr, Eq. (20)</span>
<span class="s1">&#39;XC_LDA_K_TF&#39;</span>                  <span class="p">:</span>   <span class="mi">50</span><span class="p">,</span> <span class="c1"># Thomas-Fermi kinetic energy functional</span>
<span class="s1">&#39;XC_LDA_K_LP&#39;</span>                  <span class="p">:</span>   <span class="mi">51</span><span class="p">,</span> <span class="c1"># Lee and Parr Gaussian ansatz</span>
<span class="s1">&#39;XC_LDA_XC_KSDT&#39;</span>               <span class="p">:</span>  <span class="mi">259</span><span class="p">,</span> <span class="c1"># Karasiev et al. parametrization</span>
<span class="s1">&#39;XC_LDA_C_CHACHIYO&#39;</span>            <span class="p">:</span>  <span class="mi">287</span><span class="p">,</span> <span class="c1"># Chachiyo simple 2 parameter correlation</span>
<span class="s1">&#39;XC_LDA_C_LP96&#39;</span>                <span class="p">:</span>  <span class="mi">289</span><span class="p">,</span> <span class="c1"># Liu-Parr correlation</span>
<span class="s1">&#39;XC_LDA_X_REL&#39;</span>                 <span class="p">:</span>  <span class="mi">532</span><span class="p">,</span> <span class="c1"># Relativistic exchange</span>
<span class="s1">&#39;XC_LDA_XC_1D_EHWLRG_1&#39;</span>        <span class="p">:</span>  <span class="mi">536</span><span class="p">,</span> <span class="c1"># LDA constructed from slab-like systems of 1 electron</span>
<span class="s1">&#39;XC_LDA_XC_1D_EHWLRG_2&#39;</span>        <span class="p">:</span>  <span class="mi">537</span><span class="p">,</span> <span class="c1"># LDA constructed from slab-like systems of 2 electrons</span>
<span class="s1">&#39;XC_LDA_XC_1D_EHWLRG_3&#39;</span>        <span class="p">:</span>  <span class="mi">538</span><span class="p">,</span> <span class="c1"># LDA constructed from slab-like systems of 3 electrons</span>
<span class="s1">&#39;XC_LDA_X_ERF&#39;</span>                 <span class="p">:</span>  <span class="mi">546</span><span class="p">,</span> <span class="c1"># Attenuated exchange LDA (erf)</span>
<span class="s1">&#39;XC_LDA_XC_LP_A&#39;</span>               <span class="p">:</span>  <span class="mi">547</span><span class="p">,</span> <span class="c1"># Lee-Parr reparametrization B</span>
<span class="s1">&#39;XC_LDA_XC_LP_B&#39;</span>               <span class="p">:</span>  <span class="mi">548</span><span class="p">,</span> <span class="c1"># Lee-Parr reparametrization B</span>
<span class="s1">&#39;XC_LDA_X_RAE&#39;</span>                 <span class="p">:</span>  <span class="mi">549</span><span class="p">,</span> <span class="c1"># Rae self-energy corrected exchange</span>
<span class="s1">&#39;XC_LDA_K_ZLP&#39;</span>                 <span class="p">:</span>  <span class="mi">550</span><span class="p">,</span> <span class="c1"># kinetic energy version of ZLP</span>
<span class="s1">&#39;XC_LDA_C_MCWEENY&#39;</span>             <span class="p">:</span>  <span class="mi">551</span><span class="p">,</span> <span class="c1"># McWeeny 76</span>
<span class="s1">&#39;XC_LDA_C_BR78&#39;</span>                <span class="p">:</span>  <span class="mi">552</span><span class="p">,</span> <span class="c1"># Brual &amp; Rothstein 78</span>
<span class="s1">&#39;XC_LDA_C_PK09&#39;</span>                <span class="p">:</span>  <span class="mi">554</span><span class="p">,</span> <span class="c1"># Proynov and Kong 2009</span>
<span class="s1">&#39;XC_LDA_C_OW_LYP&#39;</span>              <span class="p">:</span>  <span class="mi">573</span><span class="p">,</span> <span class="c1"># Wigner with corresponding LYP parameters</span>
<span class="s1">&#39;XC_LDA_C_OW&#39;</span>                  <span class="p">:</span>  <span class="mi">574</span><span class="p">,</span> <span class="c1"># Optimized Wigner</span>
<span class="s1">&#39;XC_LDA_XC_GDSMFB&#39;</span>             <span class="p">:</span>  <span class="mi">577</span><span class="p">,</span> <span class="c1"># Groth et al. parametrization</span>
<span class="s1">&#39;XC_LDA_C_GK72&#39;</span>                <span class="p">:</span>  <span class="mi">578</span><span class="p">,</span> <span class="c1"># Gordon and Kim 1972</span>
<span class="s1">&#39;XC_LDA_C_KARASIEV&#39;</span>            <span class="p">:</span>  <span class="mi">579</span><span class="p">,</span> <span class="c1"># Karasiev reparameterization of Chachiyo</span>
<span class="s1">&#39;XC_LDA_K_LP96&#39;</span>                <span class="p">:</span>  <span class="mi">580</span><span class="p">,</span> <span class="c1"># Liu-Parr kinetic</span>
<span class="s1">&#39;XC_GGA_X_GAM&#39;</span>                 <span class="p">:</span>   <span class="mi">32</span><span class="p">,</span> <span class="c1"># GAM functional from Minnesota</span>
<span class="s1">&#39;XC_GGA_C_GAM&#39;</span>                 <span class="p">:</span>   <span class="mi">33</span><span class="p">,</span> <span class="c1"># GAM functional from Minnesota</span>
<span class="s1">&#39;XC_GGA_X_HCTH_A&#39;</span>              <span class="p">:</span>   <span class="mi">34</span><span class="p">,</span> <span class="c1"># HCTH-A</span>
<span class="s1">&#39;XC_GGA_X_EV93&#39;</span>                <span class="p">:</span>   <span class="mi">35</span><span class="p">,</span> <span class="c1"># Engel and Vosko</span>
<span class="s1">&#39;XC_GGA_X_BCGP&#39;</span>                <span class="p">:</span>   <span class="mi">38</span><span class="p">,</span> <span class="c1"># Burke, Cancio, Gould, and Pittalis</span>
<span class="s1">&#39;XC_GGA_C_BCGP&#39;</span>                <span class="p">:</span>   <span class="mi">39</span><span class="p">,</span> <span class="c1"># Burke, Cancio, Gould, and Pittalis</span>
<span class="s1">&#39;XC_GGA_X_LAMBDA_OC2_N&#39;</span>        <span class="p">:</span>   <span class="mi">40</span><span class="p">,</span> <span class="c1"># lambda_OC2(N) version of PBE</span>
<span class="s1">&#39;XC_GGA_X_B86_R&#39;</span>               <span class="p">:</span>   <span class="mi">41</span><span class="p">,</span> <span class="c1"># Revised Becke 86 Xalpha,beta,gamma (with mod. grad. correction)</span>
<span class="s1">&#39;XC_GGA_X_LAMBDA_CH_N&#39;</span>         <span class="p">:</span>   <span class="mi">44</span><span class="p">,</span> <span class="c1"># lambda_CH(N) version of PBE</span>
<span class="s1">&#39;XC_GGA_X_LAMBDA_LO_N&#39;</span>         <span class="p">:</span>   <span class="mi">45</span><span class="p">,</span> <span class="c1"># lambda_LO(N) version of PBE</span>
<span class="s1">&#39;XC_GGA_X_HJS_B88_V2&#39;</span>          <span class="p">:</span>   <span class="mi">46</span><span class="p">,</span> <span class="c1"># HJS screened exchange corrected B88 version</span>
<span class="s1">&#39;XC_GGA_C_Q2D&#39;</span>                 <span class="p">:</span>   <span class="mi">47</span><span class="p">,</span> <span class="c1"># Chiodo et al</span>
<span class="s1">&#39;XC_GGA_X_Q2D&#39;</span>                 <span class="p">:</span>   <span class="mi">48</span><span class="p">,</span> <span class="c1"># Chiodo et al</span>
<span class="s1">&#39;XC_GGA_X_PBE_MOL&#39;</span>             <span class="p">:</span>   <span class="mi">49</span><span class="p">,</span> <span class="c1"># Del Campo, Gazquez, Trickey and Vela (PBE-like)</span>
<span class="s1">&#39;XC_GGA_K_TFVW&#39;</span>                <span class="p">:</span>   <span class="mi">52</span><span class="p">,</span> <span class="c1"># Thomas-Fermi plus von Weiszaecker correction</span>
<span class="s1">&#39;XC_GGA_K_REVAPBEINT&#39;</span>          <span class="p">:</span>   <span class="mi">53</span><span class="p">,</span> <span class="c1"># interpolated version of REVAPBE</span>
<span class="s1">&#39;XC_GGA_K_APBEINT&#39;</span>             <span class="p">:</span>   <span class="mi">54</span><span class="p">,</span> <span class="c1"># interpolated version of APBE</span>
<span class="s1">&#39;XC_GGA_K_REVAPBE&#39;</span>             <span class="p">:</span>   <span class="mi">55</span><span class="p">,</span> <span class="c1"># revised APBE</span>
<span class="s1">&#39;XC_GGA_X_AK13&#39;</span>                <span class="p">:</span>   <span class="mi">56</span><span class="p">,</span> <span class="c1"># Armiento &amp; Kuemmel 2013</span>
<span class="s1">&#39;XC_GGA_K_MEYER&#39;</span>               <span class="p">:</span>   <span class="mi">57</span><span class="p">,</span> <span class="c1"># Meyer,  Wang, and Young</span>
<span class="s1">&#39;XC_GGA_X_LV_RPW86&#39;</span>            <span class="p">:</span>   <span class="mi">58</span><span class="p">,</span> <span class="c1"># Berland and Hyldgaard</span>
<span class="s1">&#39;XC_GGA_X_PBE_TCA&#39;</span>             <span class="p">:</span>   <span class="mi">59</span><span class="p">,</span> <span class="c1"># PBE revised by Tognetti et al</span>
<span class="s1">&#39;XC_GGA_X_PBEINT&#39;</span>              <span class="p">:</span>   <span class="mi">60</span><span class="p">,</span> <span class="c1"># PBE for hybrid interfaces</span>
<span class="s1">&#39;XC_GGA_C_ZPBEINT&#39;</span>             <span class="p">:</span>   <span class="mi">61</span><span class="p">,</span> <span class="c1"># spin-dependent gradient correction to PBEint</span>
<span class="s1">&#39;XC_GGA_C_PBEINT&#39;</span>              <span class="p">:</span>   <span class="mi">62</span><span class="p">,</span> <span class="c1"># PBE for hybrid interfaces</span>
<span class="s1">&#39;XC_GGA_C_ZPBESOL&#39;</span>             <span class="p">:</span>   <span class="mi">63</span><span class="p">,</span> <span class="c1"># spin-dependent gradient correction to PBEsol</span>
<span class="s1">&#39;XC_GGA_XC_OPBE_D&#39;</span>             <span class="p">:</span>   <span class="mi">65</span><span class="p">,</span> <span class="c1"># oPBE_D functional of Goerigk and Grimme</span>
<span class="s1">&#39;XC_GGA_XC_OPWLYP_D&#39;</span>           <span class="p">:</span>   <span class="mi">66</span><span class="p">,</span> <span class="c1"># oPWLYP-D functional of Goerigk and Grimme</span>
<span class="s1">&#39;XC_GGA_XC_OBLYP_D&#39;</span>            <span class="p">:</span>   <span class="mi">67</span><span class="p">,</span> <span class="c1"># oBLYP-D functional of Goerigk and Grimme</span>
<span class="s1">&#39;XC_GGA_X_VMT84_GE&#39;</span>            <span class="p">:</span>   <span class="mi">68</span><span class="p">,</span> <span class="c1"># VMT{8,4} with constraint satisfaction with mu = mu_GE</span>
<span class="s1">&#39;XC_GGA_X_VMT84_PBE&#39;</span>           <span class="p">:</span>   <span class="mi">69</span><span class="p">,</span> <span class="c1"># VMT{8,4} with constraint satisfaction with mu = mu_PBE</span>
<span class="s1">&#39;XC_GGA_X_VMT_GE&#39;</span>              <span class="p">:</span>   <span class="mi">70</span><span class="p">,</span> <span class="c1"># Vela, Medel, and Trickey with mu = mu_GE</span>
<span class="s1">&#39;XC_GGA_X_VMT_PBE&#39;</span>             <span class="p">:</span>   <span class="mi">71</span><span class="p">,</span> <span class="c1"># Vela, Medel, and Trickey with mu = mu_PBE</span>
<span class="s1">&#39;XC_GGA_C_N12_SX&#39;</span>              <span class="p">:</span>   <span class="mi">79</span><span class="p">,</span> <span class="c1"># N12-SX functional from Minnesota</span>
<span class="s1">&#39;XC_GGA_C_N12&#39;</span>                 <span class="p">:</span>   <span class="mi">80</span><span class="p">,</span> <span class="c1"># N12 functional from Minnesota</span>
<span class="s1">&#39;XC_GGA_X_N12&#39;</span>                 <span class="p">:</span>   <span class="mi">82</span><span class="p">,</span> <span class="c1"># N12 functional from Minnesota</span>
<span class="s1">&#39;XC_GGA_C_REGTPSS&#39;</span>             <span class="p">:</span>   <span class="mi">83</span><span class="p">,</span> <span class="c1"># Regularized TPSS correlation (ex-VPBE)</span>
<span class="s1">&#39;XC_GGA_C_OP_XALPHA&#39;</span>           <span class="p">:</span>   <span class="mi">84</span><span class="p">,</span> <span class="c1"># one-parameter progressive functional (XALPHA version)</span>
<span class="s1">&#39;XC_GGA_C_OP_G96&#39;</span>              <span class="p">:</span>   <span class="mi">85</span><span class="p">,</span> <span class="c1"># one-parameter progressive functional (G96 version)</span>
<span class="s1">&#39;XC_GGA_C_OP_PBE&#39;</span>              <span class="p">:</span>   <span class="mi">86</span><span class="p">,</span> <span class="c1"># one-parameter progressive functional (PBE version)</span>
<span class="s1">&#39;XC_GGA_C_OP_B88&#39;</span>              <span class="p">:</span>   <span class="mi">87</span><span class="p">,</span> <span class="c1"># one-parameter progressive functional (B88 version)</span>
<span class="s1">&#39;XC_GGA_C_FT97&#39;</span>                <span class="p">:</span>   <span class="mi">88</span><span class="p">,</span> <span class="c1"># Filatov &amp; Thiel correlation</span>
<span class="s1">&#39;XC_GGA_C_SPBE&#39;</span>                <span class="p">:</span>   <span class="mi">89</span><span class="p">,</span> <span class="c1"># PBE correlation to be used with the SSB exchange</span>
<span class="s1">&#39;XC_GGA_X_SSB_SW&#39;</span>              <span class="p">:</span>   <span class="mi">90</span><span class="p">,</span> <span class="c1"># Swart, Sola and Bickelhaupt correction to PBE</span>
<span class="s1">&#39;XC_GGA_X_SSB&#39;</span>                 <span class="p">:</span>   <span class="mi">91</span><span class="p">,</span> <span class="c1"># Swart, Sola and Bickelhaupt</span>
<span class="s1">&#39;XC_GGA_X_SSB_D&#39;</span>               <span class="p">:</span>   <span class="mi">92</span><span class="p">,</span> <span class="c1"># Swart, Sola and Bickelhaupt dispersion</span>
<span class="s1">&#39;XC_GGA_XC_HCTH_407P&#39;</span>          <span class="p">:</span>   <span class="mi">93</span><span class="p">,</span> <span class="c1"># HCTH/407+</span>
<span class="s1">&#39;XC_GGA_XC_HCTH_P76&#39;</span>           <span class="p">:</span>   <span class="mi">94</span><span class="p">,</span> <span class="c1"># HCTH p=7/6</span>
<span class="s1">&#39;XC_GGA_XC_HCTH_P14&#39;</span>           <span class="p">:</span>   <span class="mi">95</span><span class="p">,</span> <span class="c1"># HCTH p=1/4</span>
<span class="s1">&#39;XC_GGA_XC_B97_GGA1&#39;</span>           <span class="p">:</span>   <span class="mi">96</span><span class="p">,</span> <span class="c1"># Becke 97 GGA-1</span>
<span class="s1">&#39;XC_GGA_C_HCTH_A&#39;</span>              <span class="p">:</span>   <span class="mi">97</span><span class="p">,</span> <span class="c1"># HCTH-A</span>
<span class="s1">&#39;XC_GGA_X_BPCCAC&#39;</span>              <span class="p">:</span>   <span class="mi">98</span><span class="p">,</span> <span class="c1"># BPCCAC (GRAC for the energy)</span>
<span class="s1">&#39;XC_GGA_C_REVTCA&#39;</span>              <span class="p">:</span>   <span class="mi">99</span><span class="p">,</span> <span class="c1"># Tognetti, Cortona, Adamo (revised)</span>
<span class="s1">&#39;XC_GGA_C_TCA&#39;</span>                 <span class="p">:</span>  <span class="mi">100</span><span class="p">,</span> <span class="c1"># Tognetti, Cortona, Adamo</span>
<span class="s1">&#39;XC_GGA_X_PBE&#39;</span>                 <span class="p">:</span>  <span class="mi">101</span><span class="p">,</span> <span class="c1"># Perdew, Burke &amp; Ernzerhof exchange</span>
<span class="s1">&#39;XC_GGA_X_PBE_R&#39;</span>               <span class="p">:</span>  <span class="mi">102</span><span class="p">,</span> <span class="c1"># Perdew, Burke &amp; Ernzerhof exchange (revised)</span>
<span class="s1">&#39;XC_GGA_X_B86&#39;</span>                 <span class="p">:</span>  <span class="mi">103</span><span class="p">,</span> <span class="c1"># Becke 86 Xalpha,beta,gamma</span>
<span class="s1">&#39;XC_GGA_X_HERMAN&#39;</span>              <span class="p">:</span>  <span class="mi">104</span><span class="p">,</span> <span class="c1"># Herman et al original GGA</span>
<span class="s1">&#39;XC_GGA_X_B86_MGC&#39;</span>             <span class="p">:</span>  <span class="mi">105</span><span class="p">,</span> <span class="c1"># Becke 86 Xalpha,beta,gamma (with mod. grad. correction)</span>
<span class="s1">&#39;XC_GGA_X_B88&#39;</span>                 <span class="p">:</span>  <span class="mi">106</span><span class="p">,</span> <span class="c1"># Becke 88</span>
<span class="s1">&#39;XC_GGA_X_G96&#39;</span>                 <span class="p">:</span>  <span class="mi">107</span><span class="p">,</span> <span class="c1"># Gill 96</span>
<span class="s1">&#39;XC_GGA_X_PW86&#39;</span>                <span class="p">:</span>  <span class="mi">108</span><span class="p">,</span> <span class="c1"># Perdew &amp; Wang 86</span>
<span class="s1">&#39;XC_GGA_X_PW91&#39;</span>                <span class="p">:</span>  <span class="mi">109</span><span class="p">,</span> <span class="c1"># Perdew &amp; Wang 91</span>
<span class="s1">&#39;XC_GGA_X_OPTX&#39;</span>                <span class="p">:</span>  <span class="mi">110</span><span class="p">,</span> <span class="c1"># Handy &amp; Cohen OPTX 01</span>
<span class="s1">&#39;XC_GGA_X_DK87_R1&#39;</span>             <span class="p">:</span>  <span class="mi">111</span><span class="p">,</span> <span class="c1"># dePristo &amp; Kress 87 (version R1)</span>
<span class="s1">&#39;XC_GGA_X_DK87_R2&#39;</span>             <span class="p">:</span>  <span class="mi">112</span><span class="p">,</span> <span class="c1"># dePristo &amp; Kress 87 (version R2)</span>
<span class="s1">&#39;XC_GGA_X_LG93&#39;</span>                <span class="p">:</span>  <span class="mi">113</span><span class="p">,</span> <span class="c1"># Lacks &amp; Gordon 93</span>
<span class="s1">&#39;XC_GGA_X_FT97_A&#39;</span>              <span class="p">:</span>  <span class="mi">114</span><span class="p">,</span> <span class="c1"># Filatov &amp; Thiel 97 (version A)</span>
<span class="s1">&#39;XC_GGA_X_FT97_B&#39;</span>              <span class="p">:</span>  <span class="mi">115</span><span class="p">,</span> <span class="c1"># Filatov &amp; Thiel 97 (version B)</span>
<span class="s1">&#39;XC_GGA_X_PBE_SOL&#39;</span>             <span class="p">:</span>  <span class="mi">116</span><span class="p">,</span> <span class="c1"># Perdew, Burke &amp; Ernzerhof exchange (solids)</span>
<span class="s1">&#39;XC_GGA_X_RPBE&#39;</span>                <span class="p">:</span>  <span class="mi">117</span><span class="p">,</span> <span class="c1"># Hammer, Hansen &amp; Norskov (PBE-like)</span>
<span class="s1">&#39;XC_GGA_X_WC&#39;</span>                  <span class="p">:</span>  <span class="mi">118</span><span class="p">,</span> <span class="c1"># Wu &amp; Cohen</span>
<span class="s1">&#39;XC_GGA_X_MPW91&#39;</span>               <span class="p">:</span>  <span class="mi">119</span><span class="p">,</span> <span class="c1"># Modified form of PW91 by Adamo &amp; Barone</span>
<span class="s1">&#39;XC_GGA_X_AM05&#39;</span>                <span class="p">:</span>  <span class="mi">120</span><span class="p">,</span> <span class="c1"># Armiento &amp; Mattsson 05 exchange</span>
<span class="s1">&#39;XC_GGA_X_PBEA&#39;</span>                <span class="p">:</span>  <span class="mi">121</span><span class="p">,</span> <span class="c1"># Madsen (PBE-like)</span>
<span class="s1">&#39;XC_GGA_X_MPBE&#39;</span>                <span class="p">:</span>  <span class="mi">122</span><span class="p">,</span> <span class="c1"># Adamo &amp; Barone modification to PBE</span>
<span class="s1">&#39;XC_GGA_X_XPBE&#39;</span>                <span class="p">:</span>  <span class="mi">123</span><span class="p">,</span> <span class="c1"># xPBE reparametrization by Xu &amp; Goddard</span>
<span class="s1">&#39;XC_GGA_X_2D_B86_MGC&#39;</span>          <span class="p">:</span>  <span class="mi">124</span><span class="p">,</span> <span class="c1"># Becke 86 MGC for 2D systems</span>
<span class="s1">&#39;XC_GGA_X_BAYESIAN&#39;</span>            <span class="p">:</span>  <span class="mi">125</span><span class="p">,</span> <span class="c1"># Bayesian best fit for the enhancement factor</span>
<span class="s1">&#39;XC_GGA_X_PBE_JSJR&#39;</span>            <span class="p">:</span>  <span class="mi">126</span><span class="p">,</span> <span class="c1"># JSJR reparametrization by Pedroza, Silva &amp; Capelle</span>
<span class="s1">&#39;XC_GGA_X_2D_B88&#39;</span>              <span class="p">:</span>  <span class="mi">127</span><span class="p">,</span> <span class="c1"># Becke 88 in 2D</span>
<span class="s1">&#39;XC_GGA_X_2D_B86&#39;</span>              <span class="p">:</span>  <span class="mi">128</span><span class="p">,</span> <span class="c1"># Becke 86 Xalpha,beta,gamma</span>
<span class="s1">&#39;XC_GGA_X_2D_PBE&#39;</span>              <span class="p">:</span>  <span class="mi">129</span><span class="p">,</span> <span class="c1"># Perdew, Burke &amp; Ernzerhof exchange in 2D</span>
<span class="s1">&#39;XC_GGA_C_PBE&#39;</span>                 <span class="p">:</span>  <span class="mi">130</span><span class="p">,</span> <span class="c1"># Perdew, Burke &amp; Ernzerhof correlation</span>
<span class="s1">&#39;XC_GGA_C_LYP&#39;</span>                 <span class="p">:</span>  <span class="mi">131</span><span class="p">,</span> <span class="c1"># Lee, Yang &amp; Parr</span>
<span class="s1">&#39;XC_GGA_C_P86&#39;</span>                 <span class="p">:</span>  <span class="mi">132</span><span class="p">,</span> <span class="c1"># Perdew 86</span>
<span class="s1">&#39;XC_GGA_C_PBE_SOL&#39;</span>             <span class="p">:</span>  <span class="mi">133</span><span class="p">,</span> <span class="c1"># Perdew, Burke &amp; Ernzerhof correlation SOL</span>
<span class="s1">&#39;XC_GGA_C_PW91&#39;</span>                <span class="p">:</span>  <span class="mi">134</span><span class="p">,</span> <span class="c1"># Perdew &amp; Wang 91</span>
<span class="s1">&#39;XC_GGA_C_AM05&#39;</span>                <span class="p">:</span>  <span class="mi">135</span><span class="p">,</span> <span class="c1"># Armiento &amp; Mattsson 05 correlation</span>
<span class="s1">&#39;XC_GGA_C_XPBE&#39;</span>                <span class="p">:</span>  <span class="mi">136</span><span class="p">,</span> <span class="c1"># xPBE reparametrization by Xu &amp; Goddard</span>
<span class="s1">&#39;XC_GGA_C_LM&#39;</span>                  <span class="p">:</span>  <span class="mi">137</span><span class="p">,</span> <span class="c1"># Langreth and Mehl correlation</span>
<span class="s1">&#39;XC_GGA_C_PBE_JRGX&#39;</span>            <span class="p">:</span>  <span class="mi">138</span><span class="p">,</span> <span class="c1"># JRGX reparametrization by Pedroza, Silva &amp; Capelle</span>
<span class="s1">&#39;XC_GGA_X_OPTB88_VDW&#39;</span>          <span class="p">:</span>  <span class="mi">139</span><span class="p">,</span> <span class="c1"># Becke 88 reoptimized to be used with vdW functional of Dion et al</span>
<span class="s1">&#39;XC_GGA_X_PBEK1_VDW&#39;</span>           <span class="p">:</span>  <span class="mi">140</span><span class="p">,</span> <span class="c1"># PBE reparametrization for vdW</span>
<span class="s1">&#39;XC_GGA_X_OPTPBE_VDW&#39;</span>          <span class="p">:</span>  <span class="mi">141</span><span class="p">,</span> <span class="c1"># PBE reparametrization for vdW</span>
<span class="s1">&#39;XC_GGA_X_RGE2&#39;</span>                <span class="p">:</span>  <span class="mi">142</span><span class="p">,</span> <span class="c1"># Regularized PBE</span>
<span class="s1">&#39;XC_GGA_C_RGE2&#39;</span>                <span class="p">:</span>  <span class="mi">143</span><span class="p">,</span> <span class="c1"># Regularized PBE</span>
<span class="s1">&#39;XC_GGA_X_RPW86&#39;</span>               <span class="p">:</span>  <span class="mi">144</span><span class="p">,</span> <span class="c1"># refitted Perdew &amp; Wang 86</span>
<span class="s1">&#39;XC_GGA_X_KT1&#39;</span>                 <span class="p">:</span>  <span class="mi">145</span><span class="p">,</span> <span class="c1"># Exchange part of Keal and Tozer version 1</span>
<span class="s1">&#39;XC_GGA_XC_KT2&#39;</span>                <span class="p">:</span>  <span class="mi">146</span><span class="p">,</span> <span class="c1"># Keal and Tozer version 2</span>
<span class="s1">&#39;XC_GGA_C_WL&#39;</span>                  <span class="p">:</span>  <span class="mi">147</span><span class="p">,</span> <span class="c1"># Wilson &amp; Levy</span>
<span class="s1">&#39;XC_GGA_C_WI&#39;</span>                  <span class="p">:</span>  <span class="mi">148</span><span class="p">,</span> <span class="c1"># Wilson &amp; Ivanov</span>
<span class="s1">&#39;XC_GGA_X_MB88&#39;</span>                <span class="p">:</span>  <span class="mi">149</span><span class="p">,</span> <span class="c1"># Modified Becke 88 for proton transfer</span>
<span class="s1">&#39;XC_GGA_X_SOGGA&#39;</span>               <span class="p">:</span>  <span class="mi">150</span><span class="p">,</span> <span class="c1"># Second-order generalized gradient approximation</span>
<span class="s1">&#39;XC_GGA_X_SOGGA11&#39;</span>             <span class="p">:</span>  <span class="mi">151</span><span class="p">,</span> <span class="c1"># Second-order generalized gradient approximation 2011</span>
<span class="s1">&#39;XC_GGA_C_SOGGA11&#39;</span>             <span class="p">:</span>  <span class="mi">152</span><span class="p">,</span> <span class="c1"># Second-order generalized gradient approximation 2011</span>
<span class="s1">&#39;XC_GGA_C_WI0&#39;</span>                 <span class="p">:</span>  <span class="mi">153</span><span class="p">,</span> <span class="c1"># Wilson &amp; Ivanov initial version</span>
<span class="s1">&#39;XC_GGA_XC_TH1&#39;</span>                <span class="p">:</span>  <span class="mi">154</span><span class="p">,</span> <span class="c1"># Tozer and Handy v. 1</span>
<span class="s1">&#39;XC_GGA_XC_TH2&#39;</span>                <span class="p">:</span>  <span class="mi">155</span><span class="p">,</span> <span class="c1"># Tozer and Handy v. 2</span>
<span class="s1">&#39;XC_GGA_XC_TH3&#39;</span>                <span class="p">:</span>  <span class="mi">156</span><span class="p">,</span> <span class="c1"># Tozer and Handy v. 3</span>
<span class="s1">&#39;XC_GGA_XC_TH4&#39;</span>                <span class="p">:</span>  <span class="mi">157</span><span class="p">,</span> <span class="c1"># Tozer and Handy v. 4</span>
<span class="s1">&#39;XC_GGA_X_C09X&#39;</span>                <span class="p">:</span>  <span class="mi">158</span><span class="p">,</span> <span class="c1"># C09x to be used with the VdW of Rutgers-Chalmers</span>
<span class="s1">&#39;XC_GGA_C_SOGGA11_X&#39;</span>           <span class="p">:</span>  <span class="mi">159</span><span class="p">,</span> <span class="c1"># To be used with HYB_GGA_X_SOGGA11_X</span>
<span class="s1">&#39;XC_GGA_X_LB&#39;</span>                  <span class="p">:</span>  <span class="mi">160</span><span class="p">,</span> <span class="c1"># van Leeuwen &amp; Baerends</span>
<span class="s1">&#39;XC_GGA_XC_HCTH_93&#39;</span>            <span class="p">:</span>  <span class="mi">161</span><span class="p">,</span> <span class="c1"># HCTH functional fitted to  93 molecules</span>
<span class="s1">&#39;XC_GGA_XC_HCTH_120&#39;</span>           <span class="p">:</span>  <span class="mi">162</span><span class="p">,</span> <span class="c1"># HCTH functional fitted to 120 molecules</span>
<span class="s1">&#39;XC_GGA_XC_HCTH_147&#39;</span>           <span class="p">:</span>  <span class="mi">163</span><span class="p">,</span> <span class="c1"># HCTH functional fitted to 147 molecules</span>
<span class="s1">&#39;XC_GGA_XC_HCTH_407&#39;</span>           <span class="p">:</span>  <span class="mi">164</span><span class="p">,</span> <span class="c1"># HCTH functional fitted to 407 molecules</span>
<span class="s1">&#39;XC_GGA_XC_EDF1&#39;</span>               <span class="p">:</span>  <span class="mi">165</span><span class="p">,</span> <span class="c1"># Empirical functionals from Adamson, Gill, and Pople</span>
<span class="s1">&#39;XC_GGA_XC_XLYP&#39;</span>               <span class="p">:</span>  <span class="mi">166</span><span class="p">,</span> <span class="c1"># XLYP functional</span>
<span class="s1">&#39;XC_GGA_XC_KT1&#39;</span>                <span class="p">:</span>  <span class="mi">167</span><span class="p">,</span> <span class="c1"># Keal and Tozer version 1</span>
<span class="s1">&#39;XC_GGA_XC_B97_D&#39;</span>              <span class="p">:</span>  <span class="mi">170</span><span class="p">,</span> <span class="c1"># Grimme functional to be used with C6 vdW term</span>
<span class="s1">&#39;XC_GGA_XC_PBE1W&#39;</span>              <span class="p">:</span>  <span class="mi">173</span><span class="p">,</span> <span class="c1"># Functionals fitted for water</span>
<span class="s1">&#39;XC_GGA_XC_MPWLYP1W&#39;</span>           <span class="p">:</span>  <span class="mi">174</span><span class="p">,</span> <span class="c1"># Functionals fitted for water</span>
<span class="s1">&#39;XC_GGA_XC_PBELYP1W&#39;</span>           <span class="p">:</span>  <span class="mi">175</span><span class="p">,</span> <span class="c1"># Functionals fitted for water</span>
<span class="s1">&#39;XC_GGA_X_LBM&#39;</span>                 <span class="p">:</span>  <span class="mi">182</span><span class="p">,</span> <span class="c1"># van Leeuwen &amp; Baerends modified</span>
<span class="s1">&#39;XC_GGA_X_OL2&#39;</span>                 <span class="p">:</span>  <span class="mi">183</span><span class="p">,</span> <span class="c1"># Exchange form based on Ou-Yang and Levy v.2</span>
<span class="s1">&#39;XC_GGA_X_APBE&#39;</span>                <span class="p">:</span>  <span class="mi">184</span><span class="p">,</span> <span class="c1"># mu fixed from the semiclassical neutral atom</span>
<span class="s1">&#39;XC_GGA_K_APBE&#39;</span>                <span class="p">:</span>  <span class="mi">185</span><span class="p">,</span> <span class="c1"># mu fixed from the semiclassical neutral atom</span>
<span class="s1">&#39;XC_GGA_C_APBE&#39;</span>                <span class="p">:</span>  <span class="mi">186</span><span class="p">,</span> <span class="c1"># mu fixed from the semiclassical neutral atom</span>
<span class="s1">&#39;XC_GGA_K_TW1&#39;</span>                 <span class="p">:</span>  <span class="mi">187</span><span class="p">,</span> <span class="c1"># Tran and Wesolowski set 1 (Table II)</span>
<span class="s1">&#39;XC_GGA_K_TW2&#39;</span>                 <span class="p">:</span>  <span class="mi">188</span><span class="p">,</span> <span class="c1"># Tran and Wesolowski set 2 (Table II)</span>
<span class="s1">&#39;XC_GGA_K_TW3&#39;</span>                 <span class="p">:</span>  <span class="mi">189</span><span class="p">,</span> <span class="c1"># Tran and Wesolowski set 3 (Table II)</span>
<span class="s1">&#39;XC_GGA_K_TW4&#39;</span>                 <span class="p">:</span>  <span class="mi">190</span><span class="p">,</span> <span class="c1"># Tran and Wesolowski set 4 (Table II)</span>
<span class="s1">&#39;XC_GGA_X_HTBS&#39;</span>                <span class="p">:</span>  <span class="mi">191</span><span class="p">,</span> <span class="c1"># Haas, Tran, Blaha, and Schwarz</span>
<span class="s1">&#39;XC_GGA_X_AIRY&#39;</span>                <span class="p">:</span>  <span class="mi">192</span><span class="p">,</span> <span class="c1"># Constantin et al based on the Airy gas</span>
<span class="s1">&#39;XC_GGA_X_LAG&#39;</span>                 <span class="p">:</span>  <span class="mi">193</span><span class="p">,</span> <span class="c1"># Local Airy Gas</span>
<span class="s1">&#39;XC_GGA_XC_MOHLYP&#39;</span>             <span class="p">:</span>  <span class="mi">194</span><span class="p">,</span> <span class="c1"># Functional for organometallic chemistry</span>
<span class="s1">&#39;XC_GGA_XC_MOHLYP2&#39;</span>            <span class="p">:</span>  <span class="mi">195</span><span class="p">,</span> <span class="c1"># Functional for barrier heights</span>
<span class="s1">&#39;XC_GGA_XC_TH_FL&#39;</span>              <span class="p">:</span>  <span class="mi">196</span><span class="p">,</span> <span class="c1"># Tozer and Handy v. FL</span>
<span class="s1">&#39;XC_GGA_XC_TH_FC&#39;</span>              <span class="p">:</span>  <span class="mi">197</span><span class="p">,</span> <span class="c1"># Tozer and Handy v. FC</span>
<span class="s1">&#39;XC_GGA_XC_TH_FCFO&#39;</span>            <span class="p">:</span>  <span class="mi">198</span><span class="p">,</span> <span class="c1"># Tozer and Handy v. FCFO</span>
<span class="s1">&#39;XC_GGA_XC_TH_FCO&#39;</span>             <span class="p">:</span>  <span class="mi">199</span><span class="p">,</span> <span class="c1"># Tozer and Handy v. FCO</span>
<span class="s1">&#39;XC_GGA_C_OPTC&#39;</span>                <span class="p">:</span>  <span class="mi">200</span><span class="p">,</span> <span class="c1"># Optimized correlation functional of Cohen and Handy</span>
<span class="s1">&#39;XC_GGA_C_PBELOC&#39;</span>              <span class="p">:</span>  <span class="mi">246</span><span class="p">,</span> <span class="c1"># Semilocal dynamical correlation</span>
<span class="s1">&#39;XC_GGA_XC_VV10&#39;</span>               <span class="p">:</span>  <span class="mi">255</span><span class="p">,</span> <span class="c1"># Vydrov and Van Voorhis</span>
<span class="s1">&#39;XC_GGA_C_PBEFE&#39;</span>               <span class="p">:</span>  <span class="mi">258</span><span class="p">,</span> <span class="c1"># PBE for formation energies</span>
<span class="s1">&#39;XC_GGA_C_OP_PW91&#39;</span>             <span class="p">:</span>  <span class="mi">262</span><span class="p">,</span> <span class="c1"># one-parameter progressive functional (PW91 version)</span>
<span class="s1">&#39;XC_GGA_X_PBEFE&#39;</span>               <span class="p">:</span>  <span class="mi">265</span><span class="p">,</span> <span class="c1"># PBE for formation energies</span>
<span class="s1">&#39;XC_GGA_X_CAP&#39;</span>                 <span class="p">:</span>  <span class="mi">270</span><span class="p">,</span> <span class="c1"># Correct Asymptotic Potential</span>
<span class="s1">&#39;XC_GGA_X_EB88&#39;</span>                <span class="p">:</span>  <span class="mi">271</span><span class="p">,</span> <span class="c1"># Non-empirical (excogitated) B88 functional of Becke and Elliott</span>
<span class="s1">&#39;XC_GGA_C_PBE_MOL&#39;</span>             <span class="p">:</span>  <span class="mi">272</span><span class="p">,</span> <span class="c1"># Del Campo, Gazquez, Trickey and Vela (PBE-like)</span>
<span class="s1">&#39;XC_GGA_K_ABSP3&#39;</span>               <span class="p">:</span>  <span class="mi">277</span><span class="p">,</span> <span class="c1"># gamma-TFvW form by Acharya et al [g = 1 - 1.513/N^0.35]</span>
<span class="s1">&#39;XC_GGA_K_ABSP4&#39;</span>               <span class="p">:</span>  <span class="mi">278</span><span class="p">,</span> <span class="c1"># gamma-TFvW form by Acharya et al [g = l = 1/(1 + 1.332/N^(1/3))]</span>
<span class="s1">&#39;XC_GGA_C_BMK&#39;</span>                 <span class="p">:</span>  <span class="mi">280</span><span class="p">,</span> <span class="c1"># Boese-Martin for kinetics</span>
<span class="s1">&#39;XC_GGA_C_TAU_HCTH&#39;</span>            <span class="p">:</span>  <span class="mi">281</span><span class="p">,</span> <span class="c1"># correlation part of tau-hcth</span>
<span class="s1">&#39;XC_GGA_C_HYB_TAU_HCTH&#39;</span>        <span class="p">:</span>  <span class="mi">283</span><span class="p">,</span> <span class="c1"># correlation part of hyb_tau-hcth</span>
<span class="s1">&#39;XC_GGA_X_BEEFVDW&#39;</span>             <span class="p">:</span>  <span class="mi">285</span><span class="p">,</span> <span class="c1"># BEEF-vdW exchange</span>
<span class="s1">&#39;XC_GGA_XC_BEEFVDW&#39;</span>            <span class="p">:</span>  <span class="mi">286</span><span class="p">,</span> <span class="c1"># BEEF-vdW exchange-correlation</span>
<span class="s1">&#39;XC_GGA_X_PBETRANS&#39;</span>            <span class="p">:</span>  <span class="mi">291</span><span class="p">,</span> <span class="c1"># Gradient-based interpolation between PBE and revPBE</span>
<span class="s1">&#39;XC_GGA_X_CHACHIYO&#39;</span>            <span class="p">:</span>  <span class="mi">298</span><span class="p">,</span> <span class="c1"># Chachiyo exchange</span>
<span class="s1">&#39;XC_GGA_K_VW&#39;</span>                  <span class="p">:</span>  <span class="mi">500</span><span class="p">,</span> <span class="c1"># von Weiszaecker functional</span>
<span class="s1">&#39;XC_GGA_K_GE2&#39;</span>                 <span class="p">:</span>  <span class="mi">501</span><span class="p">,</span> <span class="c1"># Second-order gradient expansion (l = 1/9)</span>
<span class="s1">&#39;XC_GGA_K_GOLDEN&#39;</span>              <span class="p">:</span>  <span class="mi">502</span><span class="p">,</span> <span class="c1"># TF-lambda-vW form by Golden (l = 13/45)</span>
<span class="s1">&#39;XC_GGA_K_YT65&#39;</span>                <span class="p">:</span>  <span class="mi">503</span><span class="p">,</span> <span class="c1"># TF-lambda-vW form by Yonei and Tomishima (l = 1/5)</span>
<span class="s1">&#39;XC_GGA_K_BALTIN&#39;</span>              <span class="p">:</span>  <span class="mi">504</span><span class="p">,</span> <span class="c1"># TF-lambda-vW form by Baltin (l = 5/9)</span>
<span class="s1">&#39;XC_GGA_K_LIEB&#39;</span>                <span class="p">:</span>  <span class="mi">505</span><span class="p">,</span> <span class="c1"># TF-lambda-vW form by Lieb (l = 0.185909191)</span>
<span class="s1">&#39;XC_GGA_K_ABSP1&#39;</span>               <span class="p">:</span>  <span class="mi">506</span><span class="p">,</span> <span class="c1"># gamma-TFvW form by Acharya et al [g = 1 - 1.412/N^(1/3)]</span>
<span class="s1">&#39;XC_GGA_K_ABSP2&#39;</span>               <span class="p">:</span>  <span class="mi">507</span><span class="p">,</span> <span class="c1"># gamma-TFvW form by Acharya et al [g = 1 - 1.332/N^(1/3)]</span>
<span class="s1">&#39;XC_GGA_K_GR&#39;</span>                  <span class="p">:</span>  <span class="mi">508</span><span class="p">,</span> <span class="c1"># gamma-TFvW form by Gazquez and Robles</span>
<span class="s1">&#39;XC_GGA_K_LUDENA&#39;</span>              <span class="p">:</span>  <span class="mi">509</span><span class="p">,</span> <span class="c1"># gamma-TFvW form by Ludena</span>
<span class="s1">&#39;XC_GGA_K_GP85&#39;</span>                <span class="p">:</span>  <span class="mi">510</span><span class="p">,</span> <span class="c1"># gamma-TFvW form by Ghosh and Parr</span>
<span class="s1">&#39;XC_GGA_K_PEARSON&#39;</span>             <span class="p">:</span>  <span class="mi">511</span><span class="p">,</span> <span class="c1"># Pearson</span>
<span class="s1">&#39;XC_GGA_K_OL1&#39;</span>                 <span class="p">:</span>  <span class="mi">512</span><span class="p">,</span> <span class="c1"># Ou-Yang and Levy v.1</span>
<span class="s1">&#39;XC_GGA_K_OL2&#39;</span>                 <span class="p">:</span>  <span class="mi">513</span><span class="p">,</span> <span class="c1"># Ou-Yang and Levy v.2</span>
<span class="s1">&#39;XC_GGA_K_FR_B88&#39;</span>              <span class="p">:</span>  <span class="mi">514</span><span class="p">,</span> <span class="c1"># Fuentealba &amp; Reyes (B88 version)</span>
<span class="s1">&#39;XC_GGA_K_FR_PW86&#39;</span>             <span class="p">:</span>  <span class="mi">515</span><span class="p">,</span> <span class="c1"># Fuentealba &amp; Reyes (PW86 version)</span>
<span class="s1">&#39;XC_GGA_K_DK&#39;</span>                  <span class="p">:</span>  <span class="mi">516</span><span class="p">,</span> <span class="c1"># DePristo and Kress</span>
<span class="s1">&#39;XC_GGA_K_PERDEW&#39;</span>              <span class="p">:</span>  <span class="mi">517</span><span class="p">,</span> <span class="c1"># Perdew</span>
<span class="s1">&#39;XC_GGA_K_VSK&#39;</span>                 <span class="p">:</span>  <span class="mi">518</span><span class="p">,</span> <span class="c1"># Vitos, Skriver, and Kollar</span>
<span class="s1">&#39;XC_GGA_K_VJKS&#39;</span>                <span class="p">:</span>  <span class="mi">519</span><span class="p">,</span> <span class="c1"># Vitos, Johansson, Kollar, and Skriver</span>
<span class="s1">&#39;XC_GGA_K_ERNZERHOF&#39;</span>           <span class="p">:</span>  <span class="mi">520</span><span class="p">,</span> <span class="c1"># Ernzerhof</span>
<span class="s1">&#39;XC_GGA_K_LC94&#39;</span>                <span class="p">:</span>  <span class="mi">521</span><span class="p">,</span> <span class="c1"># Lembarki &amp; Chermette</span>
<span class="s1">&#39;XC_GGA_K_LLP&#39;</span>                 <span class="p">:</span>  <span class="mi">522</span><span class="p">,</span> <span class="c1"># Lee, Lee &amp; Parr</span>
<span class="s1">&#39;XC_GGA_K_THAKKAR&#39;</span>             <span class="p">:</span>  <span class="mi">523</span><span class="p">,</span> <span class="c1"># Thakkar 1992</span>
<span class="s1">&#39;XC_GGA_X_WPBEH&#39;</span>               <span class="p">:</span>  <span class="mi">524</span><span class="p">,</span> <span class="c1"># short-range version of the PBE</span>
<span class="s1">&#39;XC_GGA_X_HJS_PBE&#39;</span>             <span class="p">:</span>  <span class="mi">525</span><span class="p">,</span> <span class="c1"># HJS screened exchange PBE version</span>
<span class="s1">&#39;XC_GGA_X_HJS_PBE_SOL&#39;</span>         <span class="p">:</span>  <span class="mi">526</span><span class="p">,</span> <span class="c1"># HJS screened exchange PBE_SOL version</span>
<span class="s1">&#39;XC_GGA_X_HJS_B88&#39;</span>             <span class="p">:</span>  <span class="mi">527</span><span class="p">,</span> <span class="c1"># HJS screened exchange B88 version</span>
<span class="s1">&#39;XC_GGA_X_HJS_B97X&#39;</span>            <span class="p">:</span>  <span class="mi">528</span><span class="p">,</span> <span class="c1"># HJS screened exchange B97x version</span>
<span class="s1">&#39;XC_GGA_X_ITYH&#39;</span>                <span class="p">:</span>  <span class="mi">529</span><span class="p">,</span> <span class="c1"># short-range recipe for exchange GGA functionals</span>
<span class="s1">&#39;XC_GGA_X_SFAT&#39;</span>                <span class="p">:</span>  <span class="mi">530</span><span class="p">,</span> <span class="c1"># short-range recipe for exchange GGA functionals</span>
<span class="s1">&#39;XC_GGA_X_SG4&#39;</span>                 <span class="p">:</span>  <span class="mi">533</span><span class="p">,</span> <span class="c1"># Semiclassical GGA at fourth order</span>
<span class="s1">&#39;XC_GGA_C_SG4&#39;</span>                 <span class="p">:</span>  <span class="mi">534</span><span class="p">,</span> <span class="c1"># Semiclassical GGA at fourth order</span>
<span class="s1">&#39;XC_GGA_X_GG99&#39;</span>                <span class="p">:</span>  <span class="mi">535</span><span class="p">,</span> <span class="c1"># Gilbert and Gill 1999</span>
<span class="s1">&#39;XC_GGA_X_PBEPOW&#39;</span>              <span class="p">:</span>  <span class="mi">539</span><span class="p">,</span> <span class="c1"># PBE power</span>
<span class="s1">&#39;XC_GGA_X_KGG99&#39;</span>               <span class="p">:</span>  <span class="mi">544</span><span class="p">,</span> <span class="c1"># Gilbert and Gill 1999 (mixed)</span>
<span class="s1">&#39;XC_GGA_XC_HLE16&#39;</span>              <span class="p">:</span>  <span class="mi">545</span><span class="p">,</span> <span class="c1"># high local exchange 2016</span>
<span class="s1">&#39;XC_GGA_C_SCAN_E0&#39;</span>             <span class="p">:</span>  <span class="mi">553</span><span class="p">,</span> <span class="c1"># GGA component of SCAN</span>
<span class="s1">&#39;XC_GGA_C_GAPC&#39;</span>                <span class="p">:</span>  <span class="mi">555</span><span class="p">,</span> <span class="c1"># GapC</span>
<span class="s1">&#39;XC_GGA_C_GAPLOC&#39;</span>              <span class="p">:</span>  <span class="mi">556</span><span class="p">,</span> <span class="c1"># Gaploc</span>
<span class="s1">&#39;XC_GGA_C_ZVPBEINT&#39;</span>            <span class="p">:</span>  <span class="mi">557</span><span class="p">,</span> <span class="c1"># another spin-dependent correction to PBEint</span>
<span class="s1">&#39;XC_GGA_C_ZVPBESOL&#39;</span>            <span class="p">:</span>  <span class="mi">558</span><span class="p">,</span> <span class="c1"># another spin-dependent correction to PBEsol</span>
<span class="s1">&#39;XC_GGA_C_TM_LYP&#39;</span>              <span class="p">:</span>  <span class="mi">559</span><span class="p">,</span> <span class="c1"># Takkar and McCarthy reparametrization</span>
<span class="s1">&#39;XC_GGA_C_TM_PBE&#39;</span>              <span class="p">:</span>  <span class="mi">560</span><span class="p">,</span> <span class="c1"># Thakkar and McCarthy reparametrization</span>
<span class="s1">&#39;XC_GGA_C_W94&#39;</span>                 <span class="p">:</span>  <span class="mi">561</span><span class="p">,</span> <span class="c1"># Wilson 94 (Eq. 25)</span>
<span class="s1">&#39;XC_GGA_C_CS1&#39;</span>                 <span class="p">:</span>  <span class="mi">565</span><span class="p">,</span> <span class="c1"># A dynamical correlation functional</span>
<span class="s1">&#39;XC_GGA_X_B88M&#39;</span>                <span class="p">:</span>  <span class="mi">570</span><span class="p">,</span> <span class="c1"># Becke 88 reoptimized to be used with mgga_c_tau1</span>
<span class="s1">&#39;XC_GGA_K_PBE3&#39;</span>                <span class="p">:</span>  <span class="mi">595</span><span class="p">,</span> <span class="c1"># Three parameter PBE-like expansion</span>
<span class="s1">&#39;XC_GGA_K_PBE4&#39;</span>                <span class="p">:</span>  <span class="mi">596</span><span class="p">,</span> <span class="c1"># Four  parameter PBE-like expansion</span>
<span class="s1">&#39;XC_GGA_K_EXP4&#39;</span>                <span class="p">:</span>  <span class="mi">597</span><span class="p">,</span> <span class="c1"># Intermediate form between PBE3 and PBE4</span>
<span class="s1">&#39;XC_HYB_GGA_X_N12_SX&#39;</span>          <span class="p">:</span>   <span class="mi">81</span><span class="p">,</span> <span class="c1"># N12-SX functional from Minnesota</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B97_1P&#39;</span>         <span class="p">:</span>  <span class="mi">266</span><span class="p">,</span> <span class="c1"># version of B97 by Cohen and Handy</span>
<span class="s1">&#39;XC_HYB_GGA_XC_PBE_MOL0&#39;</span>       <span class="p">:</span>  <span class="mi">273</span><span class="p">,</span> <span class="c1"># PBEmol0</span>
<span class="s1">&#39;XC_HYB_GGA_XC_PBE_SOL0&#39;</span>       <span class="p">:</span>  <span class="mi">274</span><span class="p">,</span> <span class="c1"># PBEsol0</span>
<span class="s1">&#39;XC_HYB_GGA_XC_PBEB0&#39;</span>          <span class="p">:</span>  <span class="mi">275</span><span class="p">,</span> <span class="c1"># PBEbeta0</span>
<span class="s1">&#39;XC_HYB_GGA_XC_PBE_MOLB0&#39;</span>      <span class="p">:</span>  <span class="mi">276</span><span class="p">,</span> <span class="c1"># PBEmolbeta0</span>
<span class="s1">&#39;XC_HYB_GGA_XC_PBE50&#39;</span>          <span class="p">:</span>  <span class="mi">290</span><span class="p">,</span> <span class="c1"># PBE0 with 50% exx</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B3PW91&#39;</span>         <span class="p">:</span>  <span class="mi">401</span><span class="p">,</span> <span class="c1"># The original (ACM) hybrid of Becke</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B3LYP&#39;</span>          <span class="p">:</span>  <span class="mi">402</span><span class="p">,</span> <span class="c1"># The (in)famous B3LYP</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B3P86&#39;</span>          <span class="p">:</span>  <span class="mi">403</span><span class="p">,</span> <span class="c1"># Perdew 86 hybrid similar to B3PW91</span>
<span class="s1">&#39;XC_HYB_GGA_XC_O3LYP&#39;</span>          <span class="p">:</span>  <span class="mi">404</span><span class="p">,</span> <span class="c1"># hybrid using the optx functional</span>
<span class="s1">&#39;XC_HYB_GGA_XC_MPW1K&#39;</span>          <span class="p">:</span>  <span class="mi">405</span><span class="p">,</span> <span class="c1"># mixture of mPW91 and PW91 optimized for kinetics</span>
<span class="s1">&#39;XC_HYB_GGA_XC_PBEH&#39;</span>           <span class="p">:</span>  <span class="mi">406</span><span class="p">,</span> <span class="c1"># aka PBE0 or PBE1PBE</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B97&#39;</span>            <span class="p">:</span>  <span class="mi">407</span><span class="p">,</span> <span class="c1"># Becke 97</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B97_1&#39;</span>          <span class="p">:</span>  <span class="mi">408</span><span class="p">,</span> <span class="c1"># Becke 97-1</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B97_2&#39;</span>          <span class="p">:</span>  <span class="mi">410</span><span class="p">,</span> <span class="c1"># Becke 97-2</span>
<span class="s1">&#39;XC_HYB_GGA_XC_X3LYP&#39;</span>          <span class="p">:</span>  <span class="mi">411</span><span class="p">,</span> <span class="c1"># hybrid by Xu and Goddard</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B1WC&#39;</span>           <span class="p">:</span>  <span class="mi">412</span><span class="p">,</span> <span class="c1"># Becke 1-parameter mixture of WC and PBE</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B97_K&#39;</span>          <span class="p">:</span>  <span class="mi">413</span><span class="p">,</span> <span class="c1"># Boese-Martin for Kinetics</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B97_3&#39;</span>          <span class="p">:</span>  <span class="mi">414</span><span class="p">,</span> <span class="c1"># Becke 97-3</span>
<span class="s1">&#39;XC_HYB_GGA_XC_MPW3PW&#39;</span>         <span class="p">:</span>  <span class="mi">415</span><span class="p">,</span> <span class="c1"># mixture with the mPW functional</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B1LYP&#39;</span>          <span class="p">:</span>  <span class="mi">416</span><span class="p">,</span> <span class="c1"># Becke 1-parameter mixture of B88 and LYP</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B1PW91&#39;</span>         <span class="p">:</span>  <span class="mi">417</span><span class="p">,</span> <span class="c1"># Becke 1-parameter mixture of B88 and PW91</span>
<span class="s1">&#39;XC_HYB_GGA_XC_MPW1PW&#39;</span>         <span class="p">:</span>  <span class="mi">418</span><span class="p">,</span> <span class="c1"># Becke 1-parameter mixture of mPW91 and PW91</span>
<span class="s1">&#39;XC_HYB_GGA_XC_MPW3LYP&#39;</span>        <span class="p">:</span>  <span class="mi">419</span><span class="p">,</span> <span class="c1"># mixture of mPW and LYP</span>
<span class="s1">&#39;XC_HYB_GGA_XC_SB98_1A&#39;</span>        <span class="p">:</span>  <span class="mi">420</span><span class="p">,</span> <span class="c1"># Schmider-Becke 98 parameterization 1a</span>
<span class="s1">&#39;XC_HYB_GGA_XC_SB98_1B&#39;</span>        <span class="p">:</span>  <span class="mi">421</span><span class="p">,</span> <span class="c1"># Schmider-Becke 98 parameterization 1b</span>
<span class="s1">&#39;XC_HYB_GGA_XC_SB98_1C&#39;</span>        <span class="p">:</span>  <span class="mi">422</span><span class="p">,</span> <span class="c1"># Schmider-Becke 98 parameterization 1c</span>
<span class="s1">&#39;XC_HYB_GGA_XC_SB98_2A&#39;</span>        <span class="p">:</span>  <span class="mi">423</span><span class="p">,</span> <span class="c1"># Schmider-Becke 98 parameterization 2a</span>
<span class="s1">&#39;XC_HYB_GGA_XC_SB98_2B&#39;</span>        <span class="p">:</span>  <span class="mi">424</span><span class="p">,</span> <span class="c1"># Schmider-Becke 98 parameterization 2b</span>
<span class="s1">&#39;XC_HYB_GGA_XC_SB98_2C&#39;</span>        <span class="p">:</span>  <span class="mi">425</span><span class="p">,</span> <span class="c1"># Schmider-Becke 98 parameterization 2c</span>
<span class="s1">&#39;XC_HYB_GGA_X_SOGGA11_X&#39;</span>       <span class="p">:</span>  <span class="mi">426</span><span class="p">,</span> <span class="c1"># Hybrid based on SOGGA11 form</span>
<span class="s1">&#39;XC_HYB_GGA_XC_HSE03&#39;</span>          <span class="p">:</span>  <span class="mi">427</span><span class="p">,</span> <span class="c1"># the 2003 version of the screened hybrid HSE</span>
<span class="s1">&#39;XC_HYB_GGA_XC_HSE06&#39;</span>          <span class="p">:</span>  <span class="mi">428</span><span class="p">,</span> <span class="c1"># the 2006 version of the screened hybrid HSE</span>
<span class="s1">&#39;XC_HYB_GGA_XC_HJS_PBE&#39;</span>        <span class="p">:</span>  <span class="mi">429</span><span class="p">,</span> <span class="c1"># HJS hybrid screened exchange PBE version</span>
<span class="s1">&#39;XC_HYB_GGA_XC_HJS_PBE_SOL&#39;</span>    <span class="p">:</span>  <span class="mi">430</span><span class="p">,</span> <span class="c1"># HJS hybrid screened exchange PBE_SOL version</span>
<span class="s1">&#39;XC_HYB_GGA_XC_HJS_B88&#39;</span>        <span class="p">:</span>  <span class="mi">431</span><span class="p">,</span> <span class="c1"># HJS hybrid screened exchange B88 version</span>
<span class="s1">&#39;XC_HYB_GGA_XC_HJS_B97X&#39;</span>       <span class="p">:</span>  <span class="mi">432</span><span class="p">,</span> <span class="c1"># HJS hybrid screened exchange B97x version</span>
<span class="s1">&#39;XC_HYB_GGA_XC_CAM_B3LYP&#39;</span>      <span class="p">:</span>  <span class="mi">433</span><span class="p">,</span> <span class="c1"># CAM version of B3LYP</span>
<span class="s1">&#39;XC_HYB_GGA_XC_TUNED_CAM_B3LYP&#39;</span><span class="p">:</span>  <span class="mi">434</span><span class="p">,</span> <span class="c1"># CAM version of B3LYP tuned for excitations</span>
<span class="s1">&#39;XC_HYB_GGA_XC_BHANDH&#39;</span>         <span class="p">:</span>  <span class="mi">435</span><span class="p">,</span> <span class="c1"># Becke half-and-half</span>
<span class="s1">&#39;XC_HYB_GGA_XC_BHANDHLYP&#39;</span>      <span class="p">:</span>  <span class="mi">436</span><span class="p">,</span> <span class="c1"># Becke half-and-half with B88 exchange</span>
<span class="s1">&#39;XC_HYB_GGA_XC_MB3LYP_RC04&#39;</span>    <span class="p">:</span>  <span class="mi">437</span><span class="p">,</span> <span class="c1"># B3LYP with RC04 LDA</span>
<span class="s1">&#39;XC_HYB_GGA_XC_MPWLYP1M&#39;</span>       <span class="p">:</span>  <span class="mi">453</span><span class="p">,</span> <span class="c1"># MPW with 1 par. for metals/LYP</span>
<span class="s1">&#39;XC_HYB_GGA_XC_REVB3LYP&#39;</span>       <span class="p">:</span>  <span class="mi">454</span><span class="p">,</span> <span class="c1"># Revised B3LYP</span>
<span class="s1">&#39;XC_HYB_GGA_XC_CAMY_BLYP&#39;</span>      <span class="p">:</span>  <span class="mi">455</span><span class="p">,</span> <span class="c1"># BLYP with yukawa screening</span>
<span class="s1">&#39;XC_HYB_GGA_XC_PBE0_13&#39;</span>        <span class="p">:</span>  <span class="mi">456</span><span class="p">,</span> <span class="c1"># PBE0-1/3</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B3LYPS&#39;</span>         <span class="p">:</span>  <span class="mi">459</span><span class="p">,</span> <span class="c1"># B3LYP* functional</span>
<span class="s1">&#39;XC_HYB_GGA_XC_WB97&#39;</span>           <span class="p">:</span>  <span class="mi">463</span><span class="p">,</span> <span class="c1"># Chai and Head-Gordon</span>
<span class="s1">&#39;XC_HYB_GGA_XC_WB97X&#39;</span>          <span class="p">:</span>  <span class="mi">464</span><span class="p">,</span> <span class="c1"># Chai and Head-Gordon</span>
<span class="s1">&#39;XC_HYB_GGA_XC_LRC_WPBEH&#39;</span>      <span class="p">:</span>  <span class="mi">465</span><span class="p">,</span> <span class="c1"># Long-range corrected functional by Rorhdanz et al</span>
<span class="s1">&#39;XC_HYB_GGA_XC_WB97X_V&#39;</span>        <span class="p">:</span>  <span class="mi">466</span><span class="p">,</span> <span class="c1"># Mardirossian and Head-Gordon</span>
<span class="s1">&#39;XC_HYB_GGA_XC_LCY_PBE&#39;</span>        <span class="p">:</span>  <span class="mi">467</span><span class="p">,</span> <span class="c1"># PBE with yukawa screening</span>
<span class="s1">&#39;XC_HYB_GGA_XC_LCY_BLYP&#39;</span>       <span class="p">:</span>  <span class="mi">468</span><span class="p">,</span> <span class="c1"># BLYP with yukawa screening</span>
<span class="s1">&#39;XC_HYB_GGA_XC_LC_VV10&#39;</span>        <span class="p">:</span>  <span class="mi">469</span><span class="p">,</span> <span class="c1"># Vydrov and Van Voorhis</span>
<span class="s1">&#39;XC_HYB_GGA_XC_CAMY_B3LYP&#39;</span>     <span class="p">:</span>  <span class="mi">470</span><span class="p">,</span> <span class="c1"># B3LYP with Yukawa screening</span>
<span class="s1">&#39;XC_HYB_GGA_XC_WB97X_D&#39;</span>        <span class="p">:</span>  <span class="mi">471</span><span class="p">,</span> <span class="c1"># Chai and Head-Gordon</span>
<span class="s1">&#39;XC_HYB_GGA_XC_HPBEINT&#39;</span>        <span class="p">:</span>  <span class="mi">472</span><span class="p">,</span> <span class="c1"># hPBEint</span>
<span class="s1">&#39;XC_HYB_GGA_XC_LRC_WPBE&#39;</span>       <span class="p">:</span>  <span class="mi">473</span><span class="p">,</span> <span class="c1"># Long-range corrected functional by Rorhdanz et al</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B3LYP5&#39;</span>         <span class="p">:</span>  <span class="mi">475</span><span class="p">,</span> <span class="c1"># B3LYP with VWN functional 5 instead of RPA</span>
<span class="s1">&#39;XC_HYB_GGA_XC_EDF2&#39;</span>           <span class="p">:</span>  <span class="mi">476</span><span class="p">,</span> <span class="c1"># Empirical functional from Lin, George and Gill</span>
<span class="s1">&#39;XC_HYB_GGA_XC_CAP0&#39;</span>           <span class="p">:</span>  <span class="mi">477</span><span class="p">,</span> <span class="c1"># Correct Asymptotic Potential hybrid</span>
<span class="s1">&#39;XC_HYB_GGA_XC_LC_WPBE&#39;</span>        <span class="p">:</span>  <span class="mi">478</span><span class="p">,</span> <span class="c1"># Long-range corrected functional by Vydrov and Scuseria</span>
<span class="s1">&#39;XC_HYB_GGA_XC_HSE12&#39;</span>          <span class="p">:</span>  <span class="mi">479</span><span class="p">,</span> <span class="c1"># HSE12 by Moussa, Schultz and Chelikowsky</span>
<span class="s1">&#39;XC_HYB_GGA_XC_HSE12S&#39;</span>         <span class="p">:</span>  <span class="mi">480</span><span class="p">,</span> <span class="c1"># Short-range HSE12 by Moussa, Schultz, and Chelikowsky</span>
<span class="s1">&#39;XC_HYB_GGA_XC_HSE_SOL&#39;</span>        <span class="p">:</span>  <span class="mi">481</span><span class="p">,</span> <span class="c1"># HSEsol functional by Schimka, Harl, and Kresse</span>
<span class="s1">&#39;XC_HYB_GGA_XC_CAM_QTP_01&#39;</span>     <span class="p">:</span>  <span class="mi">482</span><span class="p">,</span> <span class="c1"># CAM-QTP(01): CAM-B3LYP retuned using ionization potentials of water</span>
<span class="s1">&#39;XC_HYB_GGA_XC_MPW1LYP&#39;</span>        <span class="p">:</span>  <span class="mi">483</span><span class="p">,</span> <span class="c1"># Becke 1-parameter mixture of mPW91 and LYP</span>
<span class="s1">&#39;XC_HYB_GGA_XC_MPW1PBE&#39;</span>        <span class="p">:</span>  <span class="mi">484</span><span class="p">,</span> <span class="c1"># Becke 1-parameter mixture of mPW91 and PBE</span>
<span class="s1">&#39;XC_HYB_GGA_XC_KMLYP&#39;</span>          <span class="p">:</span>  <span class="mi">485</span><span class="p">,</span> <span class="c1"># Kang-Musgrave hybrid</span>
<span class="s1">&#39;XC_HYB_GGA_XC_B5050LYP&#39;</span>       <span class="p">:</span>  <span class="mi">572</span><span class="p">,</span> <span class="c1"># Like B3LYP but more exact exchange</span>
<span class="s1">&#39;XC_MGGA_C_DLDF&#39;</span>               <span class="p">:</span>   <span class="mi">37</span><span class="p">,</span> <span class="c1"># Dispersionless Density Functional</span>
<span class="s1">&#39;XC_MGGA_XC_ZLP&#39;</span>               <span class="p">:</span>   <span class="mi">42</span><span class="p">,</span> <span class="c1"># Zhao, Levy &amp; Parr, Eq. (21)</span>
<span class="s1">&#39;XC_MGGA_XC_OTPSS_D&#39;</span>           <span class="p">:</span>   <span class="mi">64</span><span class="p">,</span> <span class="c1"># oTPSS_D functional of Goerigk and Grimme</span>
<span class="s1">&#39;XC_MGGA_C_CS&#39;</span>                 <span class="p">:</span>   <span class="mi">72</span><span class="p">,</span> <span class="c1"># Colle and Salvetti</span>
<span class="s1">&#39;XC_MGGA_C_MN12_SX&#39;</span>            <span class="p">:</span>   <span class="mi">73</span><span class="p">,</span> <span class="c1"># MN12-SX correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_C_MN12_L&#39;</span>             <span class="p">:</span>   <span class="mi">74</span><span class="p">,</span> <span class="c1"># MN12-L correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_C_M11_L&#39;</span>              <span class="p">:</span>   <span class="mi">75</span><span class="p">,</span> <span class="c1"># M11-L correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_C_M11&#39;</span>                <span class="p">:</span>   <span class="mi">76</span><span class="p">,</span> <span class="c1"># M11 correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_C_M08_SO&#39;</span>             <span class="p">:</span>   <span class="mi">77</span><span class="p">,</span> <span class="c1"># M08-SO correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_C_M08_HX&#39;</span>             <span class="p">:</span>   <span class="mi">78</span><span class="p">,</span> <span class="c1"># M08-HX correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_X_LTA&#39;</span>                <span class="p">:</span>  <span class="mi">201</span><span class="p">,</span> <span class="c1"># Local tau approximation of Ernzerhof &amp; Scuseria</span>
<span class="s1">&#39;XC_MGGA_X_TPSS&#39;</span>               <span class="p">:</span>  <span class="mi">202</span><span class="p">,</span> <span class="c1"># Tao, Perdew, Staroverov &amp; Scuseria exchange</span>
<span class="s1">&#39;XC_MGGA_X_M06_L&#39;</span>              <span class="p">:</span>  <span class="mi">203</span><span class="p">,</span> <span class="c1"># M06-L exchange functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_X_GVT4&#39;</span>               <span class="p">:</span>  <span class="mi">204</span><span class="p">,</span> <span class="c1"># GVT4 from Van Voorhis and Scuseria</span>
<span class="s1">&#39;XC_MGGA_X_TAU_HCTH&#39;</span>           <span class="p">:</span>  <span class="mi">205</span><span class="p">,</span> <span class="c1"># tau-HCTH from Boese and Handy</span>
<span class="s1">&#39;XC_MGGA_X_BR89&#39;</span>               <span class="p">:</span>  <span class="mi">206</span><span class="p">,</span> <span class="c1"># Becke-Roussel 89</span>
<span class="s1">&#39;XC_MGGA_X_BJ06&#39;</span>               <span class="p">:</span>  <span class="mi">207</span><span class="p">,</span> <span class="c1"># Becke &amp; Johnson correction to Becke-Roussel 89</span>
<span class="s1">&#39;XC_MGGA_X_TB09&#39;</span>               <span class="p">:</span>  <span class="mi">208</span><span class="p">,</span> <span class="c1"># Tran &amp; Blaha correction to Becke &amp; Johnson</span>
<span class="s1">&#39;XC_MGGA_X_RPP09&#39;</span>              <span class="p">:</span>  <span class="mi">209</span><span class="p">,</span> <span class="c1"># Rasanen, Pittalis, and Proetto correction to Becke &amp; Johnson</span>
<span class="s1">&#39;XC_MGGA_X_2D_PRHG07&#39;</span>          <span class="p">:</span>  <span class="mi">210</span><span class="p">,</span> <span class="c1"># Pittalis, Rasanen, Helbig, Gross Exchange Functional</span>
<span class="s1">&#39;XC_MGGA_X_2D_PRHG07_PRP10&#39;</span>    <span class="p">:</span>  <span class="mi">211</span><span class="p">,</span> <span class="c1"># PRGH07 with PRP10 correction</span>
<span class="s1">&#39;XC_MGGA_X_REVTPSS&#39;</span>            <span class="p">:</span>  <span class="mi">212</span><span class="p">,</span> <span class="c1"># revised Tao, Perdew, Staroverov &amp; Scuseria exchange</span>
<span class="s1">&#39;XC_MGGA_X_PKZB&#39;</span>               <span class="p">:</span>  <span class="mi">213</span><span class="p">,</span> <span class="c1"># Perdew, Kurth, Zupan, and Blaha</span>
<span class="s1">&#39;XC_MGGA_X_M05&#39;</span>                <span class="p">:</span>  <span class="mi">214</span><span class="p">,</span> <span class="c1"># Worker for M05 functional</span>
<span class="s1">&#39;XC_MGGA_X_M05_2X&#39;</span>             <span class="p">:</span>  <span class="mi">215</span><span class="p">,</span> <span class="c1"># Worker for M05-2X functional</span>
<span class="s1">&#39;XC_MGGA_X_M06_HF&#39;</span>             <span class="p">:</span>  <span class="mi">216</span><span class="p">,</span> <span class="c1"># Worker for M06-HF functional</span>
<span class="s1">&#39;XC_MGGA_X_M06&#39;</span>                <span class="p">:</span>  <span class="mi">217</span><span class="p">,</span> <span class="c1"># Worker for M06 functional</span>
<span class="s1">&#39;XC_MGGA_X_M06_2X&#39;</span>             <span class="p">:</span>  <span class="mi">218</span><span class="p">,</span> <span class="c1"># Worker for M06-2X functional</span>
<span class="s1">&#39;XC_MGGA_X_M08_HX&#39;</span>             <span class="p">:</span>  <span class="mi">219</span><span class="p">,</span> <span class="c1"># Worker for M08-HX functional</span>
<span class="s1">&#39;XC_MGGA_X_M08_SO&#39;</span>             <span class="p">:</span>  <span class="mi">220</span><span class="p">,</span> <span class="c1"># Worker for M08-SO functional</span>
<span class="s1">&#39;XC_MGGA_X_MS0&#39;</span>                <span class="p">:</span>  <span class="mi">221</span><span class="p">,</span> <span class="c1"># MS exchange of Sun, Xiao, and Ruzsinszky</span>
<span class="s1">&#39;XC_MGGA_X_MS1&#39;</span>                <span class="p">:</span>  <span class="mi">222</span><span class="p">,</span> <span class="c1"># MS1 exchange of Sun, et al</span>
<span class="s1">&#39;XC_MGGA_X_MS2&#39;</span>                <span class="p">:</span>  <span class="mi">223</span><span class="p">,</span> <span class="c1"># MS2 exchange of Sun, et al</span>
<span class="s1">&#39;XC_MGGA_X_M11&#39;</span>                <span class="p">:</span>  <span class="mi">225</span><span class="p">,</span> <span class="c1"># Worker for M11 functional</span>
<span class="s1">&#39;XC_MGGA_X_M11_L&#39;</span>              <span class="p">:</span>  <span class="mi">226</span><span class="p">,</span> <span class="c1"># M11-L exchange functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_X_MN12_L&#39;</span>             <span class="p">:</span>  <span class="mi">227</span><span class="p">,</span> <span class="c1"># MN12-L exchange functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_XC_CC06&#39;</span>              <span class="p">:</span>  <span class="mi">229</span><span class="p">,</span> <span class="c1"># Cancio and Chou 2006</span>
<span class="s1">&#39;XC_MGGA_X_MK00&#39;</span>               <span class="p">:</span>  <span class="mi">230</span><span class="p">,</span> <span class="c1"># Exchange for accurate virtual orbital energies</span>
<span class="s1">&#39;XC_MGGA_C_TPSS&#39;</span>               <span class="p">:</span>  <span class="mi">231</span><span class="p">,</span> <span class="c1"># Tao, Perdew, Staroverov &amp; Scuseria correlation</span>
<span class="s1">&#39;XC_MGGA_C_VSXC&#39;</span>               <span class="p">:</span>  <span class="mi">232</span><span class="p">,</span> <span class="c1"># VSxc from Van Voorhis and Scuseria (correlation part)</span>
<span class="s1">&#39;XC_MGGA_C_M06_L&#39;</span>              <span class="p">:</span>  <span class="mi">233</span><span class="p">,</span> <span class="c1"># M06-L correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_C_M06_HF&#39;</span>             <span class="p">:</span>  <span class="mi">234</span><span class="p">,</span> <span class="c1"># M06-HF correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_C_M06&#39;</span>                <span class="p">:</span>  <span class="mi">235</span><span class="p">,</span> <span class="c1"># M06 correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_C_M06_2X&#39;</span>             <span class="p">:</span>  <span class="mi">236</span><span class="p">,</span> <span class="c1"># M06-2X correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_C_M05&#39;</span>                <span class="p">:</span>  <span class="mi">237</span><span class="p">,</span> <span class="c1"># M05 correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_C_M05_2X&#39;</span>             <span class="p">:</span>  <span class="mi">238</span><span class="p">,</span> <span class="c1"># M05-2X correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_C_PKZB&#39;</span>               <span class="p">:</span>  <span class="mi">239</span><span class="p">,</span> <span class="c1"># Perdew, Kurth, Zupan, and Blaha</span>
<span class="s1">&#39;XC_MGGA_C_BC95&#39;</span>               <span class="p">:</span>  <span class="mi">240</span><span class="p">,</span> <span class="c1"># Becke correlation 95</span>
<span class="s1">&#39;XC_MGGA_C_REVTPSS&#39;</span>            <span class="p">:</span>  <span class="mi">241</span><span class="p">,</span> <span class="c1"># revised TPSS correlation</span>
<span class="s1">&#39;XC_MGGA_XC_TPSSLYP1W&#39;</span>         <span class="p">:</span>  <span class="mi">242</span><span class="p">,</span> <span class="c1"># Functionals fitted for water</span>
<span class="s1">&#39;XC_MGGA_X_MK00B&#39;</span>              <span class="p">:</span>  <span class="mi">243</span><span class="p">,</span> <span class="c1"># Exchange for accurate virtual orbital energies (v. B)</span>
<span class="s1">&#39;XC_MGGA_X_BLOC&#39;</span>               <span class="p">:</span>  <span class="mi">244</span><span class="p">,</span> <span class="c1"># functional with balanced localization</span>
<span class="s1">&#39;XC_MGGA_X_MODTPSS&#39;</span>            <span class="p">:</span>  <span class="mi">245</span><span class="p">,</span> <span class="c1"># Modified Tao, Perdew, Staroverov &amp; Scuseria exchange</span>
<span class="s1">&#39;XC_MGGA_C_TPSSLOC&#39;</span>            <span class="p">:</span>  <span class="mi">247</span><span class="p">,</span> <span class="c1"># Semilocal dynamical correlation</span>
<span class="s1">&#39;XC_MGGA_X_MBEEF&#39;</span>              <span class="p">:</span>  <span class="mi">249</span><span class="p">,</span> <span class="c1"># mBEEF exchange</span>
<span class="s1">&#39;XC_MGGA_X_MBEEFVDW&#39;</span>           <span class="p">:</span>  <span class="mi">250</span><span class="p">,</span> <span class="c1"># mBEEF-vdW exchange</span>
<span class="s1">&#39;XC_MGGA_XC_B97M_V&#39;</span>            <span class="p">:</span>  <span class="mi">254</span><span class="p">,</span> <span class="c1"># Mardirossian and Head-Gordon</span>
<span class="s1">&#39;XC_MGGA_X_MVS&#39;</span>                <span class="p">:</span>  <span class="mi">257</span><span class="p">,</span> <span class="c1"># MVS exchange of Sun, Perdew, and Ruzsinszky</span>
<span class="s1">&#39;XC_MGGA_X_MN15_L&#39;</span>             <span class="p">:</span>  <span class="mi">260</span><span class="p">,</span> <span class="c1"># MN15-L exhange functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_C_MN15_L&#39;</span>             <span class="p">:</span>  <span class="mi">261</span><span class="p">,</span> <span class="c1"># MN15-L correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_X_SCAN&#39;</span>               <span class="p">:</span>  <span class="mi">263</span><span class="p">,</span> <span class="c1"># SCAN exchange of Sun, Ruzsinszky, and Perdew</span>
<span class="s1">&#39;XC_MGGA_C_SCAN&#39;</span>               <span class="p">:</span>  <span class="mi">267</span><span class="p">,</span> <span class="c1"># SCAN correlation</span>
<span class="s1">&#39;XC_MGGA_C_MN15&#39;</span>               <span class="p">:</span>  <span class="mi">269</span><span class="p">,</span> <span class="c1"># MN15 correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_X_B00&#39;</span>                <span class="p">:</span>  <span class="mi">284</span><span class="p">,</span> <span class="c1"># Becke 2000</span>
<span class="s1">&#39;XC_MGGA_XC_HLE17&#39;</span>             <span class="p">:</span>  <span class="mi">288</span><span class="p">,</span> <span class="c1"># high local exchange 2017</span>
<span class="s1">&#39;XC_MGGA_C_SCAN_RVV10&#39;</span>         <span class="p">:</span>  <span class="mi">292</span><span class="p">,</span> <span class="c1"># SCAN correlation + rVV10 correlation</span>
<span class="s1">&#39;XC_MGGA_X_REVM06_L&#39;</span>           <span class="p">:</span>  <span class="mi">293</span><span class="p">,</span> <span class="c1"># revised M06-L exchange functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_C_REVM06_L&#39;</span>           <span class="p">:</span>  <span class="mi">294</span><span class="p">,</span> <span class="c1"># Revised M06-L correlation functional from Minnesota</span>
<span class="s1">&#39;XC_MGGA_X_TM&#39;</span>                 <span class="p">:</span>  <span class="mi">540</span><span class="p">,</span> <span class="c1"># Tao and Mo 2016</span>
<span class="s1">&#39;XC_MGGA_X_VT84&#39;</span>               <span class="p">:</span>  <span class="mi">541</span><span class="p">,</span> <span class="c1"># meta-GGA version of VT{8,4} GGA</span>
<span class="s1">&#39;XC_MGGA_X_SA_TPSS&#39;</span>            <span class="p">:</span>  <span class="mi">542</span><span class="p">,</span> <span class="c1"># TPSS with correct surface asymptotics</span>
<span class="s1">&#39;XC_MGGA_K_PC07&#39;</span>               <span class="p">:</span>  <span class="mi">543</span><span class="p">,</span> <span class="c1"># Perdew and Constantin 2007</span>
<span class="s1">&#39;XC_MGGA_C_KCIS&#39;</span>               <span class="p">:</span>  <span class="mi">562</span><span class="p">,</span> <span class="c1"># Krieger, Chen, Iafrate, and Savin</span>
<span class="s1">&#39;XC_MGGA_XC_LP90&#39;</span>              <span class="p">:</span>  <span class="mi">564</span><span class="p">,</span> <span class="c1"># Lee &amp; Parr, Eq. (56)</span>
<span class="s1">&#39;XC_MGGA_C_B88&#39;</span>                <span class="p">:</span>  <span class="mi">571</span><span class="p">,</span> <span class="c1"># Meta-GGA correlation by Becke</span>
<span class="s1">&#39;XC_MGGA_X_GX&#39;</span>                 <span class="p">:</span>  <span class="mi">575</span><span class="p">,</span> <span class="c1"># GX functional of Loos</span>
<span class="s1">&#39;XC_MGGA_X_PBE_GX&#39;</span>             <span class="p">:</span>  <span class="mi">576</span><span class="p">,</span> <span class="c1"># PBE-GX functional of Loos</span>
<span class="s1">&#39;XC_MGGA_X_REVSCAN&#39;</span>            <span class="p">:</span>  <span class="mi">581</span><span class="p">,</span> <span class="c1"># revised SCAN</span>
<span class="s1">&#39;XC_MGGA_C_REVSCAN&#39;</span>            <span class="p">:</span>  <span class="mi">582</span><span class="p">,</span> <span class="c1"># revised SCAN correlation</span>
<span class="s1">&#39;XC_MGGA_C_SCAN_VV10&#39;</span>          <span class="p">:</span>  <span class="mi">584</span><span class="p">,</span> <span class="c1"># SCAN correlation +  VV10 correlation</span>
<span class="s1">&#39;XC_MGGA_C_REVSCAN_VV10&#39;</span>       <span class="p">:</span>  <span class="mi">585</span><span class="p">,</span> <span class="c1"># revised SCAN correlation</span>
<span class="s1">&#39;XC_MGGA_X_BR89_EXPLICIT&#39;</span>      <span class="p">:</span>  <span class="mi">586</span><span class="p">,</span> <span class="c1"># Becke-Roussel 89 with an explicit inversion of x(y)</span>
<span class="s1">&#39;XC_HYB_MGGA_X_DLDF&#39;</span>           <span class="p">:</span>   <span class="mi">36</span><span class="p">,</span> <span class="c1"># Dispersionless Density Functional</span>
<span class="s1">&#39;XC_HYB_MGGA_X_MS2H&#39;</span>           <span class="p">:</span>  <span class="mi">224</span><span class="p">,</span> <span class="c1"># MS2 hybrid exchange of Sun, et al</span>
<span class="s1">&#39;XC_HYB_MGGA_X_MN12_SX&#39;</span>        <span class="p">:</span>  <span class="mi">248</span><span class="p">,</span> <span class="c1"># MN12-SX hybrid exchange functional from Minnesota</span>
<span class="s1">&#39;XC_HYB_MGGA_X_SCAN0&#39;</span>          <span class="p">:</span>  <span class="mi">264</span><span class="p">,</span> <span class="c1"># SCAN hybrid exchange</span>
<span class="s1">&#39;XC_HYB_MGGA_X_MN15&#39;</span>           <span class="p">:</span>  <span class="mi">268</span><span class="p">,</span> <span class="c1"># MN15 hybrid exchange functional from Minnesota</span>
<span class="s1">&#39;XC_HYB_MGGA_X_BMK&#39;</span>            <span class="p">:</span>  <span class="mi">279</span><span class="p">,</span> <span class="c1"># Boese-Martin for kinetics</span>
<span class="s1">&#39;XC_HYB_MGGA_X_TAU_HCTH&#39;</span>       <span class="p">:</span>  <span class="mi">282</span><span class="p">,</span> <span class="c1"># Hybrid version of tau-HCTH</span>
<span class="s1">&#39;XC_HYB_MGGA_X_M08_HX&#39;</span>         <span class="p">:</span>  <span class="mi">295</span><span class="p">,</span> <span class="c1"># M08-HX exchange functional from Minnesota</span>
<span class="s1">&#39;XC_HYB_MGGA_X_M08_SO&#39;</span>         <span class="p">:</span>  <span class="mi">296</span><span class="p">,</span> <span class="c1"># M08-SO exchange functional from Minnesota</span>
<span class="s1">&#39;XC_HYB_MGGA_X_M11&#39;</span>            <span class="p">:</span>  <span class="mi">297</span><span class="p">,</span> <span class="c1"># M11 hybrid exchange functional from Minnesota</span>
<span class="c1"># In libxc-4.2.3, they are &#39;XC_HYB_MGGA_X_M05&#39;, &#39;XC_HYB_MGGA_X_M05_2X&#39;.</span>
<span class="c1"># When these keys are used, the parser may incorrectly pick them for</span>
<span class="c1"># xc_code=&#39;m05,&#39; when XC_MGGA_X_M05 is actually targeted.  XC_MGGA_X_M05</span>
<span class="c1"># agrees to the xcfun M05X very well. Not sure which M05X should be</span>
<span class="c1"># used by default when using libxc-4.2.3.</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_M05&#39;</span>           <span class="p">:</span>  <span class="mi">438</span><span class="p">,</span> <span class="c1"># M05 functional from Minnesota</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_M05_2X&#39;</span>        <span class="p">:</span>  <span class="mi">439</span><span class="p">,</span> <span class="c1"># M05-2X functional from Minnesota</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_B88B95&#39;</span>        <span class="p">:</span>  <span class="mi">440</span><span class="p">,</span> <span class="c1"># Mixture of B88 with BC95 (B1B95)</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_B86B95&#39;</span>        <span class="p">:</span>  <span class="mi">441</span><span class="p">,</span> <span class="c1"># Mixture of B86 with BC95</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_PW86B95&#39;</span>       <span class="p">:</span>  <span class="mi">442</span><span class="p">,</span> <span class="c1"># Mixture of PW86 with BC95</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_BB1K&#39;</span>          <span class="p">:</span>  <span class="mi">443</span><span class="p">,</span> <span class="c1"># Mixture of B88 with BC95 from Zhao and Truhlar</span>
<span class="s1">&#39;XC_HYB_MGGA_X_M06_HF&#39;</span>         <span class="p">:</span>  <span class="mi">444</span><span class="p">,</span> <span class="c1"># M06-HF hybrid exchange functional from Minnesota</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_MPW1B95&#39;</span>       <span class="p">:</span>  <span class="mi">445</span><span class="p">,</span> <span class="c1"># Mixture of mPW91 with BC95 from Zhao and Truhlar</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_MPWB1K&#39;</span>        <span class="p">:</span>  <span class="mi">446</span><span class="p">,</span> <span class="c1"># Mixture of mPW91 with BC95 for kinetics</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_X1B95&#39;</span>         <span class="p">:</span>  <span class="mi">447</span><span class="p">,</span> <span class="c1"># Mixture of X with BC95</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_XB1K&#39;</span>          <span class="p">:</span>  <span class="mi">448</span><span class="p">,</span> <span class="c1"># Mixture of X with BC95 for kinetics</span>
<span class="c1"># In libxc-4.2.3, they are &#39;XC_HYB_MGGA_X_M06&#39;, &#39;XC_HYB_MGGA_X_M06_2X&#39;.</span>
<span class="c1"># When these keys are used, the parser may incorrectly pick them for</span>
<span class="c1"># xc_code=&#39;m06,&#39; when XC_MGGA_X_M06 is actually targeted.  XC_MGGA_X_M06</span>
<span class="c1"># agrees to the xcfun M06X very well. Not sure which M06X should be</span>
<span class="c1"># used by default when using libxc-4.2.3.</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_M06&#39;</span>           <span class="p">:</span>  <span class="mi">449</span><span class="p">,</span> <span class="c1"># M06 functional from Minnesota</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_M06_2X&#39;</span>        <span class="p">:</span>  <span class="mi">450</span><span class="p">,</span> <span class="c1"># M06-2X functional from Minnesota</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_PW6B95&#39;</span>        <span class="p">:</span>  <span class="mi">451</span><span class="p">,</span> <span class="c1"># Mixture of PW91 with BC95 from Zhao and Truhlar</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_PWB6K&#39;</span>         <span class="p">:</span>  <span class="mi">452</span><span class="p">,</span> <span class="c1"># Mixture of PW91 with BC95 from Zhao and Truhlar for kinetics</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_TPSSH&#39;</span>         <span class="p">:</span>  <span class="mi">457</span><span class="p">,</span> <span class="c1"># TPSS hybrid</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_REVTPSSH&#39;</span>      <span class="p">:</span>  <span class="mi">458</span><span class="p">,</span> <span class="c1"># revTPSS hybrid</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_M08_HX&#39;</span>        <span class="p">:</span>  <span class="mi">460</span><span class="p">,</span> <span class="c1"># M08-HX functional from Minnesota</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_M08_SO&#39;</span>        <span class="p">:</span>  <span class="mi">461</span><span class="p">,</span> <span class="c1"># M08-SO functional from Minnesota</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_M11&#39;</span>           <span class="p">:</span>  <span class="mi">462</span><span class="p">,</span> <span class="c1"># M11 functional from Minnesota</span>
<span class="s1">&#39;XC_HYB_MGGA_X_MVSH&#39;</span>           <span class="p">:</span>  <span class="mi">474</span><span class="p">,</span> <span class="c1"># MVSh hybrid</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_WB97M_V&#39;</span>       <span class="p">:</span>  <span class="mi">531</span><span class="p">,</span> <span class="c1"># Mardirossian and Head-Gordon</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_B0KCIS&#39;</span>        <span class="p">:</span>  <span class="mi">563</span><span class="p">,</span> <span class="c1"># Hybrid based on KCIS</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_MPW1KCIS&#39;</span>      <span class="p">:</span>  <span class="mi">566</span><span class="p">,</span> <span class="c1"># Modified Perdew-Wang + KCIS hybrid</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_MPWKCIS1K&#39;</span>     <span class="p">:</span>  <span class="mi">567</span><span class="p">,</span> <span class="c1"># Modified Perdew-Wang + KCIS hybrid with more exact exchange</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_PBE1KCIS&#39;</span>      <span class="p">:</span>  <span class="mi">568</span><span class="p">,</span> <span class="c1"># Perdew-Burke-Ernzerhof + KCIS hybrid</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_TPSS1KCIS&#39;</span>     <span class="p">:</span>  <span class="mi">569</span><span class="p">,</span> <span class="c1"># TPSS hybrid with KCIS correlation</span>
<span class="s1">&#39;XC_HYB_MGGA_X_REVSCAN0&#39;</span>       <span class="p">:</span>  <span class="mi">583</span><span class="p">,</span> <span class="c1"># revised SCAN hybrid exchange</span>
<span class="s1">&#39;XC_HYB_MGGA_XC_B98&#39;</span>           <span class="p">:</span>  <span class="mi">598</span><span class="p">,</span> <span class="c1"># Becke 98</span>
<span class="c1">#</span>
<span class="c1"># alias</span>
<span class="c1">#</span>
<span class="s1">&#39;LDA&#39;</span>           <span class="p">:</span> <span class="mi">1</span> <span class="p">,</span>
<span class="s1">&#39;SLATER&#39;</span>        <span class="p">:</span> <span class="mi">1</span> <span class="p">,</span>
<span class="s1">&#39;VWN3&#39;</span>          <span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
<span class="s1">&#39;VWNRPA&#39;</span>        <span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
<span class="s1">&#39;VWN5&#39;</span>          <span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
<span class="s1">&#39;B88&#39;</span>           <span class="p">:</span> <span class="mi">106</span><span class="p">,</span>
<span class="s1">&#39;BLYP&#39;</span>          <span class="p">:</span> <span class="s1">&#39;B88,LYP&#39;</span><span class="p">,</span>
<span class="s1">&#39;BP86&#39;</span>          <span class="p">:</span> <span class="s1">&#39;B88,P86&#39;</span><span class="p">,</span>
<span class="s1">&#39;PBE0&#39;</span>          <span class="p">:</span> <span class="mi">406</span><span class="p">,</span>
<span class="s1">&#39;PBE1PBE&#39;</span>       <span class="p">:</span> <span class="mi">406</span><span class="p">,</span>
<span class="s1">&#39;OPTXCORR&#39;</span>      <span class="p">:</span> <span class="s1">&#39;0.7344536875999693*SLATER - 0.6984752285760186*OPTX,&#39;</span><span class="p">,</span>
<span class="s1">&#39;B3LYP&#39;</span>         <span class="p">:</span> <span class="s1">&#39;B3LYP5&#39;</span><span class="p">,</span>  <span class="c1"># VWN5 version</span>
<span class="s1">&#39;B3LYP5&#39;</span>        <span class="p">:</span> <span class="s1">&#39;.2*HF + .08*SLATER + .72*B88, .81*LYP + .19*VWN&#39;</span><span class="p">,</span>
<span class="s1">&#39;B3LYPG&#39;</span>        <span class="p">:</span> <span class="mi">402</span><span class="p">,</span>  <span class="c1"># VWN3, used by Gaussian</span>
<span class="s1">&#39;B3P86&#39;</span>         <span class="p">:</span> <span class="s1">&#39;B3P865&#39;</span><span class="p">,</span>  <span class="c1"># VWN5 version</span>
<span class="s1">&#39;B3P865&#39;</span>        <span class="p">:</span> <span class="s1">&#39;.2*HF + .08*SLATER + .72*B88, .81*P86 + .19*VWN&#39;</span><span class="p">,</span>
<span class="c1">#?&#39;B3P86G&#39;        : 403,  # VWN3, used by Gaussian</span>
<span class="s1">&#39;B3P86G&#39;</span>        <span class="p">:</span> <span class="s1">&#39;.2*HF + .08*SLATER + .72*B88, .81*P86 + .19*VWN3&#39;</span><span class="p">,</span>
<span class="s1">&#39;B3PW91&#39;</span>        <span class="p">:</span> <span class="s1">&#39;B3PW915&#39;</span><span class="p">,</span>
<span class="s1">&#39;B3PW915&#39;</span>       <span class="p">:</span> <span class="s1">&#39;.2*HF + .08*SLATER + .72*B88, .81*PW91 + .19*VWN&#39;</span><span class="p">,</span>
<span class="c1">#&#39;B3PW91G&#39;       : &#39;.2*HF + .08*SLATER + .72*B88, .81*PW91 + .19*VWN3&#39;,</span>
<span class="s1">&#39;B3PW91G&#39;</span>       <span class="p">:</span> <span class="mi">401</span><span class="p">,</span>
<span class="c1">#&#39;O3LYP5&#39;        : &#39;.1161*HF + .9262*SLATER + .8133*OPTXCORR, .81*LYP + .19*VWN5&#39;,</span>
<span class="c1">#&#39;O3LYPG&#39;        : &#39;.1161*HF + .9262*SLATER + .8133*OPTXCORR, .81*LYP + .19*VWN3&#39;,</span>
<span class="s1">&#39;O3LYP&#39;</span>         <span class="p">:</span> <span class="mi">404</span><span class="p">,</span> <span class="c1"># in libxc == &#39;.1161*HF + 0.071006917*SLATER + .8133*OPTX, .81*LYP + .19*VWN5&#39;, may be erroreous</span>
<span class="s1">&#39;MPW3PW&#39;</span>        <span class="p">:</span> <span class="s1">&#39;MPW3PW5&#39;</span><span class="p">,</span>  <span class="c1"># VWN5 version</span>
<span class="s1">&#39;MPW3PW5&#39;</span>       <span class="p">:</span> <span class="s1">&#39;.2*HF + .08*SLATER + .72*MPW91, .81*PW91 + .19*VWN&#39;</span><span class="p">,</span>
<span class="s1">&#39;MPW3PWG&#39;</span>       <span class="p">:</span> <span class="mi">415</span><span class="p">,</span>  <span class="c1"># VWN3, used by Gaussian</span>
<span class="s1">&#39;MPW3LYP&#39;</span>       <span class="p">:</span> <span class="s1">&#39;MPW3LYP5&#39;</span><span class="p">,</span>  <span class="c1"># VWN5 version</span>
<span class="s1">&#39;MPW3LYP5&#39;</span>      <span class="p">:</span> <span class="s1">&#39;.218*HF + .073*SLATER + .709*MPW91, .871*LYP + .129*VWN&#39;</span><span class="p">,</span>
<span class="s1">&#39;MPW3LYPG&#39;</span>      <span class="p">:</span> <span class="mi">419</span><span class="p">,</span>  <span class="c1"># VWN3, used by Gaussian</span>
<span class="s1">&#39;REVB3LYP&#39;</span>      <span class="p">:</span> <span class="s1">&#39;REVB3LYP5&#39;</span><span class="p">,</span>  <span class="c1"># VWN5 version</span>
<span class="s1">&#39;REVB3LYP5&#39;</span>     <span class="p">:</span> <span class="s1">&#39;.2*HF + .13*SLATER + .67*B88, .84*LYP + .16*VWN&#39;</span><span class="p">,</span>
<span class="s1">&#39;REVB3LYPG&#39;</span>     <span class="p">:</span> <span class="mi">454</span><span class="p">,</span>  <span class="c1"># VWN3, used by Gaussian</span>
<span class="s1">&#39;X3LYP&#39;</span>         <span class="p">:</span> <span class="s1">&#39;X3LYP5&#39;</span><span class="p">,</span>  <span class="c1"># VWN5 version</span>
<span class="s1">&#39;X3LYP5&#39;</span>        <span class="p">:</span> <span class="s1">&#39;.218*HF + .073*SLATER + .542385*B88 + .166615*PW91, .871*LYP + .129*VWN&#39;</span><span class="p">,</span>
<span class="s1">&#39;X3LYPG&#39;</span>        <span class="p">:</span> <span class="mi">411</span><span class="p">,</span>  <span class="c1"># VWN3, used by Gaussian</span>
<span class="s1">&#39;CAMB3LYP&#39;</span>      <span class="p">:</span> <span class="s1">&#39;XC_HYB_GGA_XC_CAM_B3LYP&#39;</span><span class="p">,</span>
<span class="s1">&#39;CAMYBLYP&#39;</span>      <span class="p">:</span> <span class="s1">&#39;XC_HYB_GGA_XC_CAMY_BLYP&#39;</span><span class="p">,</span>
<span class="s1">&#39;CAMYB3LYP&#39;</span>     <span class="p">:</span> <span class="s1">&#39;XC_HYB_GGA_XC_CAMY_B3LYP&#39;</span><span class="p">,</span>
<span class="s1">&#39;B5050LYP&#39;</span>      <span class="p">:</span> <span class="s1">&#39;.5*HF + .08*SLATER + .42*B88, .81*LYP + .19*VWN&#39;</span><span class="p">,</span>
<span class="s1">&#39;MPW1LYP&#39;</span>       <span class="p">:</span> <span class="s1">&#39;.25*HF + .75*MPW91, LYP&#39;</span><span class="p">,</span>
<span class="s1">&#39;MPW1PBE&#39;</span>       <span class="p">:</span> <span class="s1">&#39;.25*HF + .75*MPW91, PBE&#39;</span><span class="p">,</span>
<span class="s1">&#39;PBE50&#39;</span>         <span class="p">:</span> <span class="s1">&#39;.5*HF + .5*PBE, PBE&#39;</span><span class="p">,</span>
<span class="s1">&#39;REVPBE0&#39;</span>       <span class="p">:</span> <span class="s1">&#39;.25*HF + .75*PBE_R, PBE&#39;</span><span class="p">,</span>
<span class="s1">&#39;B1B95&#39;</span>         <span class="p">:</span> <span class="mi">440</span><span class="p">,</span>
<span class="s1">&#39;TPSS0&#39;</span>         <span class="p">:</span> <span class="s1">&#39;.25*HF + .75*TPSS, TPSS&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">_xc_key_without_underscore</span><span class="p">(</span><span class="n">xc_keys</span><span class="p">):</span>
    <span class="n">new_xc</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">xc_keys</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;XC_&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">delimeter</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;_XC_&#39;</span><span class="p">,</span> <span class="s1">&#39;_X_&#39;</span><span class="p">,</span> <span class="s1">&#39;_C_&#39;</span><span class="p">,</span> <span class="s1">&#39;_K_&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">delimeter</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                    <span class="n">key0</span><span class="p">,</span> <span class="n">key1</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">delimeter</span><span class="p">)</span>
                    <span class="n">new_key1</span> <span class="o">=</span> <span class="n">key1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">key1</span> <span class="o">!=</span> <span class="n">new_key1</span><span class="p">:</span>
                        <span class="n">new_xc</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">key0</span><span class="o">+</span><span class="n">delimeter</span><span class="o">+</span><span class="n">new_key1</span><span class="p">,</span> <span class="n">XC_CODES</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>
                    <span class="k">break</span>
    <span class="k">return</span> <span class="n">new_xc</span>
<span class="n">XC_CODES</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">_xc_key_without_underscore</span><span class="p">(</span><span class="n">XC_CODES</span><span class="p">))</span>
<span class="k">del</span><span class="p">(</span><span class="n">_xc_key_without_underscore</span><span class="p">)</span>

<span class="n">XC_KEYS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">XC_CODES</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="c1"># Some XC functionals have conventional name, like M06-L means M06-L for X</span>
<span class="c1"># functional and M06-L for C functional, PBE mean PBE-X plus PBE-C. If the</span>
<span class="c1"># conventional name was placed in the XC_CODES, it may lead to recursive</span>
<span class="c1"># reference when parsing the xc description.  These names (as exceptions of</span>
<span class="c1"># XC_CODES) are listed in XC_ALIAS below and they should be treated as a</span>
<span class="c1"># shortcut for XC functional.</span>
<span class="n">XC_ALIAS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># Conventional name : name in XC_CODES</span>
    <span class="s1">&#39;BLYP&#39;</span>              <span class="p">:</span> <span class="s1">&#39;B88,LYP&#39;</span><span class="p">,</span>
    <span class="s1">&#39;BP86&#39;</span>              <span class="p">:</span> <span class="s1">&#39;B88,P86&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PW91&#39;</span>              <span class="p">:</span> <span class="s1">&#39;PW91,PW91&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PBE&#39;</span>               <span class="p">:</span> <span class="s1">&#39;PBE,PBE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;REVPBE&#39;</span>            <span class="p">:</span> <span class="s1">&#39;PBE_R,PBE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PBESOL&#39;</span>            <span class="p">:</span> <span class="s1">&#39;PBE_SOL,PBE_SOL&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PKZB&#39;</span>              <span class="p">:</span> <span class="s1">&#39;PKZB,PKZB&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TPSS&#39;</span>              <span class="p">:</span> <span class="s1">&#39;TPSS,TPSS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;REVTPSS&#39;</span>           <span class="p">:</span> <span class="s1">&#39;REVTPSS,REVTPSS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SCAN&#39;</span>              <span class="p">:</span> <span class="s1">&#39;SCAN,SCAN&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SOGGA&#39;</span>             <span class="p">:</span> <span class="s1">&#39;SOGGA,PBE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;BLOC&#39;</span>              <span class="p">:</span> <span class="s1">&#39;BLOC,TPSSLOC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;OLYP&#39;</span>              <span class="p">:</span> <span class="s1">&#39;OPTX,LYP&#39;</span><span class="p">,</span>
    <span class="s1">&#39;RPBE&#39;</span>              <span class="p">:</span> <span class="s1">&#39;RPBE,PBE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;BPBE&#39;</span>              <span class="p">:</span> <span class="s1">&#39;B88,PBE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MPW91&#39;</span>             <span class="p">:</span> <span class="s1">&#39;MPW91,PW91&#39;</span><span class="p">,</span>
    <span class="s1">&#39;HFLYP&#39;</span>             <span class="p">:</span> <span class="s1">&#39;HF,LYP&#39;</span><span class="p">,</span>
    <span class="s1">&#39;HFPW92&#39;</span>            <span class="p">:</span> <span class="s1">&#39;HF,PW_MOD&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SPW92&#39;</span>             <span class="p">:</span> <span class="s1">&#39;SLATER,PW_MOD&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SVWN&#39;</span>              <span class="p">:</span> <span class="s1">&#39;SLATER,VWN&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MS0&#39;</span>               <span class="p">:</span> <span class="s1">&#39;MS0,REGTPSS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MS1&#39;</span>               <span class="p">:</span> <span class="s1">&#39;MS1,REGTPSS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MS2&#39;</span>               <span class="p">:</span> <span class="s1">&#39;MS2,REGTPSS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MS2H&#39;</span>              <span class="p">:</span> <span class="s1">&#39;MS2H,REGTPSS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MVS&#39;</span>               <span class="p">:</span> <span class="s1">&#39;MVS,REGTPSS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MVSH&#39;</span>              <span class="p">:</span> <span class="s1">&#39;MVSH,REGTPSS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SOGGA11&#39;</span>           <span class="p">:</span> <span class="s1">&#39;SOGGA11,SOGGA11&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SOGGA11-X&#39;</span>         <span class="p">:</span> <span class="s1">&#39;SOGGA11_X,SOGGA11_X&#39;</span><span class="p">,</span>
    <span class="s1">&#39;KT1&#39;</span>               <span class="p">:</span> <span class="s1">&#39;KT1,VWN&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DLDF&#39;</span>              <span class="p">:</span> <span class="s1">&#39;DLDF,DLDF&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GAM&#39;</span>               <span class="p">:</span> <span class="s1">&#39;GAM,GAM&#39;</span><span class="p">,</span>
    <span class="s1">&#39;M06-L&#39;</span>             <span class="p">:</span> <span class="s1">&#39;M06_L,M06_L&#39;</span><span class="p">,</span>
    <span class="s1">&#39;M11-L&#39;</span>             <span class="p">:</span> <span class="s1">&#39;M11_L,M11_L&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MN12-L&#39;</span>            <span class="p">:</span> <span class="s1">&#39;MN12_L,MN12_L&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MN15-L&#39;</span>            <span class="p">:</span> <span class="s1">&#39;MN15_L,MN15_L&#39;</span><span class="p">,</span>
    <span class="s1">&#39;N12&#39;</span>               <span class="p">:</span> <span class="s1">&#39;N12,N12&#39;</span><span class="p">,</span>
    <span class="s1">&#39;N12-SX&#39;</span>            <span class="p">:</span> <span class="s1">&#39;N12_SX,N12_SX&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MN12-SX&#39;</span>           <span class="p">:</span> <span class="s1">&#39;MN12_SX,MN12_SX&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MN15&#39;</span>              <span class="p">:</span> <span class="s1">&#39;MN15,MN15&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MBEEF&#39;</span>             <span class="p">:</span> <span class="s1">&#39;MBEEF,PBE_SOL&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SCAN0&#39;</span>             <span class="p">:</span> <span class="s1">&#39;SCAN0,SCAN&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PBEOP&#39;</span>             <span class="p">:</span> <span class="s1">&#39;PBE,OP_PBE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;BOP&#39;</span>               <span class="p">:</span> <span class="s1">&#39;B88,OP_B88&#39;</span><span class="p">,</span>
    <span class="c1"># new in libxc-4.2.3</span>
    <span class="s1">&#39;REVSCAN&#39;</span>           <span class="p">:</span> <span class="s1">&#39;XC_MGGA_X_REVSCAN,XC_MGGA_C_REVSCAN&#39;</span><span class="p">,</span>
    <span class="s1">&#39;REVSCAN_VV10&#39;</span>      <span class="p">:</span> <span class="s1">&#39;XC_MGGA_X_REVSCAN,XC_MGGA_C_REVSCAN_VV10&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SCAN_VV10&#39;</span>         <span class="p">:</span> <span class="s1">&#39;XC_MGGA_X_SCAN,XC_MGGA_C_SCAN_VV10&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SCAN_RVV10&#39;</span>        <span class="p">:</span> <span class="s1">&#39;XC_MGGA_X_SCAN,XC_MGGA_C_SCAN_RVV10&#39;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">XC_ALIAS</span><span class="o">.</span><span class="n">update</span><span class="p">([(</span><span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">XC_ALIAS</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                 <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">XC_ALIAS</span> <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">])</span>

<span class="n">VV10_XC</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="s1">&#39;B97M_V&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97M_V&#39;</span><span class="p">,</span> <span class="s1">&#39;WB97X_V&#39;</span><span class="p">,</span> <span class="s1">&#39;VV10&#39;</span><span class="p">,</span> <span class="s1">&#39;LC_VV10&#39;</span><span class="p">,</span>
               <span class="s1">&#39;REVSCAN_VV10&#39;</span><span class="p">,</span> <span class="s1">&#39;SCAN_VV10&#39;</span><span class="p">,</span> <span class="s1">&#39;SCAN_RVV10&#39;</span><span class="p">))</span>

<span class="n">PROBLEMATIC_XC</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">XC_CODES</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span>
                       <span class="p">(</span><span class="s1">&#39;XC_GGA_C_SPBE&#39;</span><span class="p">,</span> <span class="s1">&#39;XC_MGGA_X_TPSS&#39;</span><span class="p">,</span> <span class="s1">&#39;XC_MGGA_X_REVTPSS&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;XC_MGGA_C_TPSSLOC&#39;</span><span class="p">,</span> <span class="s1">&#39;XC_HYB_MGGA_XC_TPSSH&#39;</span><span class="p">)])</span>

<span class="k">def</span> <span class="nf">xc_type</span><span class="p">(</span><span class="n">xc_code</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_nlc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;NLC&#39;</span>
        <span class="n">hyb</span><span class="p">,</span> <span class="n">fn_facs</span> <span class="o">=</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fn_facs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">xc_code</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>  <span class="c1"># mimic fn_facs</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fn_facs</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;HF&#39;</span>
    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_is_lda</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">xid</span><span class="p">))</span> <span class="k">for</span> <span class="n">xid</span><span class="p">,</span> <span class="n">fac</span> <span class="ow">in</span> <span class="n">fn_facs</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;LDA&#39;</span>
    <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_is_meta_gga</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">xid</span><span class="p">))</span> <span class="k">for</span> <span class="n">xid</span><span class="p">,</span> <span class="n">fac</span> <span class="ow">in</span> <span class="n">fn_facs</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;MGGA&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># any(_itrf.LIBXC_is_gga(ctypes.c_int(xid)) for xid, fac in fn_facs)</span>
        <span class="c1"># include hybrid_xc</span>
        <span class="k">return</span> <span class="s1">&#39;GGA&#39;</span>

<span class="k">def</span> <span class="nf">is_lda</span><span class="p">(</span><span class="n">xc_code</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">xc_type</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;LDA&#39;</span>

<span class="k">def</span> <span class="nf">is_hybrid_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">xc_code</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_is_hybrid</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;HF&#39;</span> <span class="ow">in</span> <span class="n">xc_code</span> <span class="ow">or</span> <span class="n">hybrid_coeff</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_is_hybrid</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">xc_code</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">((</span><span class="n">is_hybrid_xc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xc_code</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">is_meta_gga</span><span class="p">(</span><span class="n">xc_code</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">xc_type</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;MGGA&#39;</span>

<span class="k">def</span> <span class="nf">is_gga</span><span class="p">(</span><span class="n">xc_code</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">xc_type</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;GGA&#39;</span>

<span class="k">def</span> <span class="nf">is_nlc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;__VV10&#39;</span> <span class="ow">in</span> <span class="n">xc_code</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">max_deriv_order</span><span class="p">(</span><span class="n">xc_code</span><span class="p">):</span>
    <span class="n">hyb</span><span class="p">,</span> <span class="n">fn_facs</span> <span class="o">=</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fn_facs</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_max_deriv_order</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">xid</span><span class="p">))</span> <span class="k">for</span> <span class="n">xid</span><span class="p">,</span> <span class="n">fac</span> <span class="ow">in</span> <span class="n">fn_facs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">3</span>

<span class="k">def</span> <span class="nf">test_deriv_order</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="n">deriv</span><span class="p">,</span> <span class="n">raise_error</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">support</span> <span class="o">=</span> <span class="n">deriv</span> <span class="o">&lt;=</span> <span class="n">max_deriv_order</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">support</span> <span class="ow">and</span> <span class="n">raise_error</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">pyscf.dft</span> <span class="k">import</span> <span class="n">xcfun</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;libxc library does not support derivative order </span><span class="si">%d</span><span class="s1"> for  </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
               <span class="p">(</span><span class="n">deriv</span><span class="p">,</span> <span class="n">xc_code</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xcfun</span><span class="o">.</span><span class="n">test_deriv_order</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="n">deriv</span><span class="p">,</span> <span class="n">raise_error</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    This functional derivative is supported in the xcfun library.</span>
<span class="s1">    The following code can be used to change the libxc library to xcfun library:</span>

<span class="s1">        from pyscf.dft import xcfun</span>
<span class="s1">        mf._numint.libxc = xcfun</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">msg</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> not found in xcfun library</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">xc_code</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span>
    <span class="k">return</span> <span class="n">support</span>

<div class="viewcode-block" id="hybrid_coeff"><a class="viewcode-back" href="../../../dft.html#pyscf.dft.libxc.hybrid_coeff">[docs]</a><span class="k">def</span> <span class="nf">hybrid_coeff</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Support recursively defining hybrid functional</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">hyb</span><span class="p">,</span> <span class="n">fn_facs</span> <span class="o">=</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">xid</span><span class="p">,</span> <span class="n">fac</span> <span class="ow">in</span> <span class="n">fn_facs</span><span class="p">:</span>
        <span class="n">hyb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">fac</span> <span class="o">*</span> <span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_hybrid_coeff</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">xid</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">hyb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="nlc_coeff"><a class="viewcode-back" href="../../../dft.html#pyscf.dft.libxc.nlc_coeff">[docs]</a><span class="k">def</span> <span class="nf">nlc_coeff</span><span class="p">(</span><span class="n">xc_code</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Get NLC coefficients</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">hyb</span><span class="p">,</span> <span class="n">fn_facs</span> <span class="o">=</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span>
    <span class="n">nlc_pars</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">nlc_tmp</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="o">*</span><span class="mi">2</span><span class="p">)()</span>
    <span class="k">for</span> <span class="n">xid</span><span class="p">,</span> <span class="n">fac</span> <span class="ow">in</span> <span class="n">fn_facs</span><span class="p">:</span>
        <span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_nlc_coeff</span><span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">nlc_tmp</span><span class="p">)</span>
        <span class="n">nlc_pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">nlc_tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nlc_pars</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">nlc_tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">nlc_pars</span></div>

<div class="viewcode-block" id="rsh_coeff"><a class="viewcode-back" href="../../../dft.html#pyscf.dft.libxc.rsh_coeff">[docs]</a><span class="k">def</span> <span class="nf">rsh_coeff</span><span class="p">(</span><span class="n">xc_code</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Range-separated parameter and HF exchange components: omega, alpha, beta</span>

<span class="sd">    Exc_RSH = c_SR * SR_HFX + c_LR * LR_HFX + (1-c_SR) * Ex_SR + (1-c_LR) * Ex_LR + Ec</span>
<span class="sd">            = alpha * HFX + beta * SR_HFX + (1-c_SR) * Ex_SR + (1-c_LR) * Ex_LR + Ec</span>
<span class="sd">            = alpha * LR_HFX + hyb * SR_HFX + (1-c_SR) * Ex_SR + (1-c_LR) * Ex_LR + Ec</span>

<span class="sd">    SR_HFX = &lt; pi | e^{-omega r_{12}}/r_{12} | iq &gt;</span>
<span class="sd">    LR_HFX = &lt; pi | (1-e^{-omega r_{12}})/r_{12} | iq &gt;</span>
<span class="sd">    alpha = c_LR</span>
<span class="sd">    beta = c_SR - c_LR = hyb - alpha</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">xc_code</span><span class="p">:</span>
        <span class="c1"># Parse only X part for the RSH coefficients.  This is to handle</span>
        <span class="c1"># exceptions for C functionals such as M11.</span>
        <span class="n">xc_code</span> <span class="o">=</span> <span class="n">xc_code</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span>
    <span class="n">hyb</span><span class="p">,</span> <span class="n">fn_facs</span> <span class="o">=</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span>

    <span class="n">hyb</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">hyb</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">hyb</span> <span class="o">-</span> <span class="n">alpha</span>
    <span class="n">rsh_pars</span> <span class="o">=</span> <span class="p">[</span><span class="n">omega</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">]</span>
    <span class="n">rsh_tmp</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="o">*</span><span class="mi">3</span><span class="p">)()</span>
    <span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_rsh_coeff</span><span class="p">(</span><span class="mi">433</span><span class="p">,</span> <span class="n">rsh_tmp</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">xid</span><span class="p">,</span> <span class="n">fac</span> <span class="ow">in</span> <span class="n">fn_facs</span><span class="p">:</span>
        <span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_rsh_coeff</span><span class="p">(</span><span class="n">xid</span><span class="p">,</span> <span class="n">rsh_tmp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rsh_pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">rsh_pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">rsh_tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">rsh_tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">rsh_pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">rsh_tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Different values of omega found for RSH functionals&#39;</span><span class="p">)</span>
        <span class="c1"># libxc-3.0.0 bug https://gitlab.com/libxc/libxc/issues/46</span>
        <span class="c1">#if _itrf.LIBXC_is_hybrid(ctypes.c_int(xid)):</span>
        <span class="c1">#    rsh_pars[1] += rsh_tmp[1] * fac</span>
        <span class="c1">#    rsh_pars[2] += rsh_tmp[2] * fac</span>
        <span class="n">rsh_pars</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">rsh_tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">fac</span>
        <span class="n">rsh_pars</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">rsh_tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">fac</span>
    <span class="k">return</span> <span class="n">rsh_pars</span></div>

<div class="viewcode-block" id="parse_xc_name"><a class="viewcode-back" href="../../../dft.html#pyscf.dft.libxc.parse_xc_name">[docs]</a><span class="k">def</span> <span class="nf">parse_xc_name</span><span class="p">(</span><span class="n">xc_name</span><span class="o">=</span><span class="s1">&#39;LDA,VWN&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Convert the XC functional name to libxc library internal ID.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">fn_facs</span> <span class="o">=</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_name</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">fn_facs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fn_facs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="parse_xc"><a class="viewcode-back" href="../../../dft.html#pyscf.dft.libxc.parse_xc">[docs]</a><span class="k">def</span> <span class="nf">parse_xc</span><span class="p">(</span><span class="n">description</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Rules to input functional description:</span>

<span class="sd">    * The given functional description must be a one-line string.</span>
<span class="sd">    * The functional description is case-insensitive.</span>
<span class="sd">    * The functional description string has two parts, separated by &quot;,&quot;.  The</span>
<span class="sd">      first part describes the exchange functional, the second is the correlation</span>
<span class="sd">      functional.</span>

<span class="sd">      - If &quot;,&quot; was not in string, the entire string is considered as a</span>
<span class="sd">        compound XC functional (including both X and C functionals, such as b3lyp).</span>
<span class="sd">      - To input only X functional (without C functional), leave the second</span>
<span class="sd">        part blank. E.g. description=&#39;slater,&#39; means pure LDA functional.</span>
<span class="sd">      - To neglect X functional (just apply C functional), leave the first</span>
<span class="sd">        part blank. E.g. description=&#39;,vwn&#39; means pure VWN functional.</span>
<span class="sd">      - If compound XC functional is specified, no matter whehter it is in the</span>
<span class="sd">        X part (the string in front of comma) or the C part (the string behind</span>
<span class="sd">        comma), both X and C functionals of the compound XC functional will be</span>
<span class="sd">        used.</span>

<span class="sd">    * The functional name can be placed in arbitrary order.  Two name needs to</span>
<span class="sd">      be separated by operators &quot;+&quot; or &quot;-&quot;.  Blank spaces are ignored.</span>
<span class="sd">      NOTE the parser only reads operators &quot;+&quot; &quot;-&quot; &quot;*&quot;.  / is not in support.</span>
<span class="sd">    * A functional name can have at most one factor.  If the factor is not</span>
<span class="sd">      given, it is set to 1.  Compound functional can be scaled as a unit. For</span>
<span class="sd">      example &#39;0.5*b3lyp&#39; is equivalent to</span>
<span class="sd">      &#39;HF*0.1 + .04*LDA + .36*B88, .405*LYP + .095*VWN&#39;</span>
<span class="sd">    * String &quot;HF&quot; stands for exact exchange (HF K matrix).  Putting &quot;HF&quot; in</span>
<span class="sd">      correlation functional part is the same to putting &quot;HF&quot; in exchange</span>
<span class="sd">      part.</span>
<span class="sd">    * String &quot;RSH&quot; means range-separated operator. Its format is</span>
<span class="sd">      RSH(alpha; beta; omega).  Another way to input RSH is to use keywords</span>
<span class="sd">      SR_HF and LR_HF: &quot;SR_HF(0.1) * alpha_plus_beta&quot; and &quot;LR_HF(0.1) *</span>
<span class="sd">      alpha&quot; where the number in parenthesis is the value of omega.</span>
<span class="sd">    * Be careful with the libxc convention on GGA functional, in which the LDA</span>
<span class="sd">      contribution has been included.</span>

<span class="sd">    Args:</span>
<span class="sd">        xc_code : str</span>
<span class="sd">            A string to describe the linear combination of different XC functionals.</span>
<span class="sd">            The X and C functional are separated by comma like &#39;.8*LDA+.2*B86,VWN&#39;.</span>
<span class="sd">            If &quot;HF&quot; was appeared in the string, it stands for the exact exchange.</span>
<span class="sd">        rho : ndarray</span>
<span class="sd">            Shape of ((*,N)) for electron density (and derivatives) if spin = 0;</span>
<span class="sd">            Shape of ((*,N),(*,N)) for alpha/beta electron density (and derivatives) if spin &gt; 0;</span>
<span class="sd">            where N is number of grids.</span>
<span class="sd">            rho (*,N) are ordered as (den,grad_x,grad_y,grad_z,laplacian,tau)</span>
<span class="sd">            where grad_x = d/dx den, laplacian = \nabla^2 den, tau = 1/2(\nabla f)^2</span>
<span class="sd">            In spin unrestricted case,</span>
<span class="sd">            rho is ((den_u,grad_xu,grad_yu,grad_zu,laplacian_u,tau_u)</span>
<span class="sd">                    (den_d,grad_xd,grad_yd,grad_zd,laplacian_d,tau_d))</span>

<span class="sd">    Kwargs:</span>
<span class="sd">        spin : int</span>
<span class="sd">            spin polarized if spin &gt; 0</span>
<span class="sd">        relativity : int</span>
<span class="sd">            No effects.</span>
<span class="sd">        verbose : int or object of :class:`Logger`</span>
<span class="sd">            No effects.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ex, vxc, fxc, kxc</span>

<span class="sd">        where</span>

<span class="sd">        * vxc = (vrho, vsigma, vlapl, vtau) for restricted case</span>

<span class="sd">        * vxc for unrestricted case</span>
<span class="sd">          | vrho[:,2]   = (u, d)</span>
<span class="sd">          | vsigma[:,3] = (uu, ud, dd)</span>
<span class="sd">          | vlapl[:,2]  = (u, d)</span>
<span class="sd">          | vtau[:,2]   = (u, d)</span>

<span class="sd">        * fxc for restricted case:</span>
<span class="sd">          (v2rho2, v2rhosigma, v2sigma2, v2lapl2, vtau2, v2rholapl, v2rhotau, v2lapltau, v2sigmalapl, v2sigmatau)</span>

<span class="sd">        * fxc for unrestricted case:</span>
<span class="sd">          | v2rho2[:,3]     = (u_u, u_d, d_d)</span>
<span class="sd">          | v2rhosigma[:,6] = (u_uu, u_ud, u_dd, d_uu, d_ud, d_dd)</span>
<span class="sd">          | v2sigma2[:,6]   = (uu_uu, uu_ud, uu_dd, ud_ud, ud_dd, dd_dd)</span>
<span class="sd">          | v2lapl2[:,3]</span>
<span class="sd">          | vtau2[:,3]</span>
<span class="sd">          | v2rholapl[:,4]</span>
<span class="sd">          | v2rhotau[:,4]</span>
<span class="sd">          | v2lapltau[:,4]</span>
<span class="sd">          | v2sigmalapl[:,6]</span>
<span class="sd">          | v2sigmatau[:,6]</span>

<span class="sd">        * kxc for restricted case:</span>
<span class="sd">          v3rho3, v3rho2sigma, v3rhosigma2, v3sigma3,</span>
<span class="sd">          v3rho2tau, v3rhosigmatau, v3rhotau2, v3sigma2tau, v3sigmatau2, v3tau3</span>

<span class="sd">        * kxc for unrestricted case:</span>
<span class="sd">          | v3rho3[:,4]       = (u_u_u, u_u_d, u_d_d, d_d_d)</span>
<span class="sd">          | v3rho2sigma[:,9]  = (u_u_uu, u_u_ud, u_u_dd, u_d_uu, u_d_ud, u_d_dd, d_d_uu, d_d_ud, d_d_dd)</span>
<span class="sd">          | v3rhosigma2[:,12] = (u_uu_uu, u_uu_ud, u_uu_dd, u_ud_ud, u_ud_dd, u_dd_dd, d_uu_uu, d_uu_ud, d_uu_dd, d_ud_ud, d_ud_dd, d_dd_dd)</span>
<span class="sd">          | v3sigma3[:,10]     = (uu_uu_uu, uu_uu_ud, uu_uu_dd, uu_ud_ud, uu_ud_dd, uu_dd_dd, ud_ud_ud, ud_ud_dd, ud_dd_dd, dd_dd_dd)</span>
<span class="sd">          | v3rho2tau</span>
<span class="sd">          | v3rhosigmatau</span>
<span class="sd">          | v3rhotau2</span>
<span class="sd">          | v3sigma2tau</span>
<span class="sd">          | v3sigmatau2</span>
<span class="sd">          | v3tau3</span>

<span class="sd">        see also libxc_itrf.c</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">hyb</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># hybrid, alpha, omega (== SR_HF, LR_HF, omega)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">hyb</span><span class="p">,</span> <span class="p">[(</span><span class="n">description</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)]</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span> <span class="c1">#isinstance(description, (tuple,list)):</span>
        <span class="k">return</span> <span class="n">parse_xc</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">description</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">assign_omega</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">hyb_or_sr</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">hyb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">omega</span> <span class="ow">or</span> <span class="n">omega</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hyb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">hyb_or_sr</span>
            <span class="n">hyb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lr</span>
        <span class="k">elif</span> <span class="n">hyb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hyb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">hyb_or_sr</span>
            <span class="n">hyb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lr</span>
            <span class="n">hyb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">omega</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Different values of omega found for RSH functionals&#39;</span><span class="p">)</span>
    <span class="n">fn_facs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">parse_token</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">possible_xc_for</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">token</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">token</span> <span class="o">=</span> <span class="n">token</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sign</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">token</span><span class="p">:</span>
                <span class="n">fac</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">fac</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
                    <span class="n">fac</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="p">,</span> <span class="n">fac</span>
                <span class="n">fac</span> <span class="o">=</span> <span class="n">sign</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">fac</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fac</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">sign</span><span class="p">,</span> <span class="n">token</span>

            <span class="k">if</span> <span class="n">key</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RSH&#39;</span><span class="p">:</span>
<span class="c1"># RSH(alpha; beta; omega): Range-separated-hybrid functional</span>
                <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">key</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)]</span>
                <span class="n">assign_omega</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">fac</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="n">beta</span><span class="p">),</span> <span class="n">fac</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;HF&#39;</span><span class="p">:</span>
                <span class="n">hyb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">fac</span>
                <span class="n">hyb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">fac</span>  <span class="c1"># also add to LR_HF</span>
            <span class="k">elif</span> <span class="s1">&#39;SR_HF&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;(&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                    <span class="n">omega</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">assign_omega</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">fac</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># Assuming this omega the same to the existing omega</span>
                    <span class="n">hyb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">fac</span>
            <span class="k">elif</span> <span class="s1">&#39;LR_HF&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;(&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                    <span class="n">omega</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">assign_omega</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fac</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">hyb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">fac</span>  <span class="c1"># == alpha</span>
            <span class="k">elif</span> <span class="n">key</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="n">fn_facs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">fac</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">XC_CODES</span><span class="p">:</span>
                    <span class="n">x_id</span> <span class="o">=</span> <span class="n">XC_CODES</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">possible_xc</span> <span class="o">=</span> <span class="n">XC_KEYS</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">possible_xc_for</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">possible_xc</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">possible_xc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Possible xc_code </span><span class="si">%s</span><span class="s1"> matches </span><span class="si">%s</span><span class="s1">. &#39;</span>
                                             <span class="o">%</span> <span class="p">(</span><span class="n">possible_xc</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
                            <span class="k">for</span> <span class="n">x_id</span> <span class="ow">in</span> <span class="n">possible_xc</span><span class="p">:</span>  <span class="c1"># Prefer X functional</span>
                                <span class="k">if</span> <span class="s1">&#39;_X_&#39;</span> <span class="ow">in</span> <span class="n">x_id</span><span class="p">:</span>
                                    <span class="k">break</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">x_id</span> <span class="o">=</span> <span class="n">possible_xc</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;XC parser takes </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x_id</span><span class="p">)</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;You can add prefix to </span><span class="si">%s</span><span class="s1"> for a &#39;</span>
                                             <span class="s1">&#39;specific functional (e.g. X_</span><span class="si">%s</span><span class="s1">, &#39;</span>
                                             <span class="s1">&#39;HYB_MGGA_X_</span><span class="si">%s</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span>
                                             <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">x_id</span> <span class="o">=</span> <span class="n">possible_xc</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                        <span class="n">x_id</span> <span class="o">=</span> <span class="n">XC_CODES</span><span class="p">[</span><span class="n">x_id</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Unknown key </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">hyb1</span><span class="p">,</span> <span class="n">fn_facs1</span> <span class="o">=</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">x_id</span><span class="p">)</span>
<span class="c1"># Recursively scale the composed functional, to support e.g. &#39;0.5*b3lyp&#39;</span>
                    <span class="k">if</span> <span class="n">hyb1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">hyb1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">assign_omega</span><span class="p">(</span><span class="n">hyb1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">hyb1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">fac</span><span class="p">,</span> <span class="n">hyb1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">fac</span><span class="p">)</span>
                    <span class="n">fn_facs</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="n">xid</span><span class="p">,</span> <span class="n">c</span><span class="o">*</span><span class="n">fac</span><span class="p">)</span> <span class="k">for</span> <span class="n">xid</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">fn_facs1</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">x_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fn_facs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x_id</span><span class="p">,</span> <span class="n">fac</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">possible_x_for</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="n">key1</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
                    <span class="s1">&#39;XC_LDA_X_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;XC_GGA_X_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;XC_MGGA_X_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
                    <span class="s1">&#39;XC_HYB_GGA_X_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;XC_HYB_MGGA_X_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">possible_xc_for</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;XC_LDA_XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;XC_GGA_XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;XC_MGGA_XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
                    <span class="s1">&#39;XC_HYB_GGA_XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;XC_HYB_MGGA_XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">possible_k_for</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
                    <span class="s1">&#39;XC_LDA_K_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;XC_GGA_K_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,))</span>
    <span class="k">def</span> <span class="nf">possible_x_k_for</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">possible_x_for</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">possible_k_for</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">possible_c_for</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
                    <span class="s1">&#39;XC_LDA_C_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;XC_GGA_C_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;XC_MGGA_C_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">remove_dup</span><span class="p">(</span><span class="n">fn_facs</span><span class="p">):</span>
        <span class="n">fn_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">facs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">fn_facs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">fn_ids</span><span class="p">:</span>
                <span class="n">facs</span><span class="p">[</span><span class="n">fn_ids</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">val</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fn_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="n">facs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">fn_ids</span><span class="p">,</span> <span class="n">facs</span><span class="p">))</span>

    <span class="n">description</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">description</span> <span class="ow">in</span> <span class="n">XC_ALIAS</span><span class="p">:</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">XC_ALIAS</span><span class="p">[</span><span class="n">description</span><span class="p">]</span>

    <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">description</span><span class="p">:</span>  <span class="c1"># To handle e.g. M06-L</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">_NAME_WITH_DASH</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">description</span><span class="p">:</span>
                <span class="n">description</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">_NAME_WITH_DASH</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

    <span class="k">if</span> <span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">x_code</span><span class="p">,</span> <span class="n">c_code</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">x_code</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;+-&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">):</span>
            <span class="n">parse_token</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">possible_x_k_for</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">c_code</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;+-&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">):</span>
            <span class="n">parse_token</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">possible_c_for</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">description</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;+-&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">):</span>
            <span class="n">parse_token</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">possible_xc_for</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hyb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># No omega is assigned. LR_HF is 0 for normal Coulomb operator</span>
        <span class="n">hyb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">hyb</span><span class="p">,</span> <span class="n">remove_dup</span><span class="p">(</span><span class="n">fn_facs</span><span class="p">)</span></div>

<span class="n">_NAME_WITH_DASH</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SR-HF&#39;</span>    <span class="p">:</span> <span class="s1">&#39;SR_HF&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;LR-HF&#39;</span>    <span class="p">:</span> <span class="s1">&#39;LR_HF&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;OTPSS-D&#39;</span>  <span class="p">:</span> <span class="s1">&#39;OTPSS_D&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;B97-1&#39;</span>    <span class="p">:</span> <span class="s1">&#39;B97_1&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;B97-2&#39;</span>    <span class="p">:</span> <span class="s1">&#39;B97_2&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;B97-3&#39;</span>    <span class="p">:</span> <span class="s1">&#39;B97_3&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;B97-K&#39;</span>    <span class="p">:</span> <span class="s1">&#39;B97_K&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;B97-D&#39;</span>    <span class="p">:</span> <span class="s1">&#39;B97_D&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;HCTH-93&#39;</span>  <span class="p">:</span> <span class="s1">&#39;HCTH_93&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;HCTH-120&#39;</span> <span class="p">:</span> <span class="s1">&#39;HCTH_120&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;HCTH-147&#39;</span> <span class="p">:</span> <span class="s1">&#39;HCTH_147&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;HCTH-407&#39;</span> <span class="p">:</span> <span class="s1">&#39;HCTH_407&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;WB97X-D&#39;</span>  <span class="p">:</span> <span class="s1">&#39;WB97X_D&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;WB97X-V&#39;</span>  <span class="p">:</span> <span class="s1">&#39;WB97X_V&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;WB97M-V&#39;</span>  <span class="p">:</span> <span class="s1">&#39;WB97M_V&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;B97M-V&#39;</span>   <span class="p">:</span> <span class="s1">&#39;B97M_V&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;M05-2X&#39;</span>   <span class="p">:</span> <span class="s1">&#39;M05_2X&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;M06-L&#39;</span>    <span class="p">:</span> <span class="s1">&#39;M06_L&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;M06-HF&#39;</span>   <span class="p">:</span> <span class="s1">&#39;M06_HF&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;M06-2X&#39;</span>   <span class="p">:</span> <span class="s1">&#39;M06_2X&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;M08-HX&#39;</span>   <span class="p">:</span> <span class="s1">&#39;M08_HX&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;M08-SO&#39;</span>   <span class="p">:</span> <span class="s1">&#39;M08_SO&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;M11-L&#39;</span>    <span class="p">:</span> <span class="s1">&#39;M11_L&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;MN12-L&#39;</span>   <span class="p">:</span> <span class="s1">&#39;MN12_L&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;MN15-L&#39;</span>   <span class="p">:</span> <span class="s1">&#39;MN15_L&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;MN12-SX&#39;</span>  <span class="p">:</span> <span class="s1">&#39;MN12_SX&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;N12-SX&#39;</span>   <span class="p">:</span> <span class="s1">&#39;N12_SX&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;LRC-WPBE&#39;</span> <span class="p">:</span> <span class="s1">&#39;LRC_WPBE&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;LRC-WPBEH&#39;</span><span class="p">:</span> <span class="s1">&#39;LRC_WPBEH&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;LC-VV10&#39;</span>  <span class="p">:</span> <span class="s1">&#39;LC_VV10&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;CAM-B3LYP&#39;</span><span class="p">:</span> <span class="s1">&#39;CAM_B3LYP&#39;</span><span class="p">}</span>


<div class="viewcode-block" id="eval_xc"><a class="viewcode-back" href="../../../dft.html#pyscf.dft.libxc.eval_xc">[docs]</a><span class="k">def</span> <span class="nf">eval_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relativity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Interface to call libxc library to evaluate XC functional, potential</span>
<span class="sd">    and functional derivatives.</span>

<span class="sd">    * The given functional xc_code must be a one-line string.</span>
<span class="sd">    * The functional xc_code is case-insensitive.</span>
<span class="sd">    * The functional xc_code string has two parts, separated by &quot;,&quot;.  The</span>
<span class="sd">      first part describes the exchange functional, the second is the correlation</span>
<span class="sd">      functional.</span>

<span class="sd">      - If &quot;,&quot; not appeared in string, the entire string is considered as X functional.</span>
<span class="sd">      - To neglect X functional (just apply C functional), leave blank in the</span>
<span class="sd">        first part, eg description=&#39;,vwn&#39; for pure VWN functional</span>

<span class="sd">    * The functional name can be placed in arbitrary order.  Two name needs to</span>
<span class="sd">      be separated by operators &quot;+&quot; or &quot;-&quot;.  Blank spaces are ignored.</span>
<span class="sd">      NOTE the parser only reads operators &quot;+&quot; &quot;-&quot; &quot;*&quot;.  / is not in support.</span>
<span class="sd">    * A functional name is associated with one factor.  If the factor is not</span>
<span class="sd">      given, it is assumed equaling 1.</span>
<span class="sd">    * String &quot;HF&quot; stands for exact exchange (HF K matrix).  It is allowed to</span>
<span class="sd">      put in C functional part.</span>
<span class="sd">    * Be careful with the libxc convention on GGA functional, in which the LDA</span>
<span class="sd">      contribution is included.</span>

<span class="sd">    Args:</span>
<span class="sd">        xc_code : str</span>
<span class="sd">            A string to describe the linear combination of different XC functionals.</span>
<span class="sd">            The X and C functional are separated by comma like &#39;.8*LDA+.2*B86,VWN&#39;.</span>
<span class="sd">            If &quot;HF&quot; (exact exchange) is appeared in the string, the HF part will</span>
<span class="sd">            be skipped.  If an empty string &quot;&quot; is given, the returns exc, vxc,...</span>
<span class="sd">            will be vectors of zeros.</span>
<span class="sd">        rho : ndarray</span>
<span class="sd">            Shape of ((*,N)) for electron density (and derivatives) if spin = 0;</span>
<span class="sd">            Shape of ((*,N),(*,N)) for alpha/beta electron density (and derivatives) if spin &gt; 0;</span>
<span class="sd">            where N is number of grids.</span>
<span class="sd">            rho (*,N) are ordered as (den,grad_x,grad_y,grad_z,laplacian,tau)</span>
<span class="sd">            where grad_x = d/dx den, laplacian = \nabla^2 den, tau = 1/2(\nabla f)^2</span>
<span class="sd">            In spin unrestricted case,</span>
<span class="sd">            rho is ((den_u,grad_xu,grad_yu,grad_zu,laplacian_u,tau_u)</span>
<span class="sd">                    (den_d,grad_xd,grad_yd,grad_zd,laplacian_d,tau_d))</span>

<span class="sd">    Kwargs:</span>
<span class="sd">        spin : int</span>
<span class="sd">            spin polarized if spin &gt; 0</span>
<span class="sd">        relativity : int</span>
<span class="sd">            No effects.</span>
<span class="sd">        verbose : int or object of :class:`Logger`</span>
<span class="sd">            No effects.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ex, vxc, fxc, kxc</span>

<span class="sd">        where</span>

<span class="sd">        * vxc = (vrho, vsigma, vlapl, vtau) for restricted case</span>

<span class="sd">        * vxc for unrestricted case</span>
<span class="sd">          | vrho[:,2]   = (u, d)</span>
<span class="sd">          | vsigma[:,3] = (uu, ud, dd)</span>
<span class="sd">          | vlapl[:,2]  = (u, d)</span>
<span class="sd">          | vtau[:,2]   = (u, d)</span>

<span class="sd">        * fxc for restricted case:</span>
<span class="sd">          (v2rho2, v2rhosigma, v2sigma2, v2lapl2, vtau2, v2rholapl, v2rhotau, v2lapltau, v2sigmalapl, v2sigmatau)</span>

<span class="sd">        * fxc for unrestricted case:</span>
<span class="sd">          | v2rho2[:,3]     = (u_u, u_d, d_d)</span>
<span class="sd">          | v2rhosigma[:,6] = (u_uu, u_ud, u_dd, d_uu, d_ud, d_dd)</span>
<span class="sd">          | v2sigma2[:,6]   = (uu_uu, uu_ud, uu_dd, ud_ud, ud_dd, dd_dd)</span>
<span class="sd">          | v2lapl2[:,3]</span>
<span class="sd">          | vtau2[:,3]</span>
<span class="sd">          | v2rholapl[:,4]</span>
<span class="sd">          | v2rhotau[:,4]</span>
<span class="sd">          | v2lapltau[:,4]</span>
<span class="sd">          | v2sigmalapl[:,6]</span>
<span class="sd">          | v2sigmatau[:,6]</span>

<span class="sd">        * kxc for restricted case:</span>
<span class="sd">          (v3rho3, v3rho2sigma, v3rhosigma2, v3sigma3)</span>

<span class="sd">        * kxc for unrestricted case:</span>
<span class="sd">          | v3rho3[:,4]       = (u_u_u, u_u_d, u_d_d, d_d_d)</span>
<span class="sd">          | v3rho2sigma[:,9]  = (u_u_uu, u_u_ud, u_u_dd, u_d_uu, u_d_ud, u_d_dd, d_d_uu, d_d_ud, d_d_dd)</span>
<span class="sd">          | v3rhosigma2[:,12] = (u_uu_uu, u_uu_ud, u_uu_dd, u_ud_ud, u_ud_dd, u_dd_dd, d_uu_uu, d_uu_ud, d_uu_dd, d_ud_ud, d_ud_dd, d_dd_dd)</span>
<span class="sd">          | v3sigma3[:,10]    = (uu_uu_uu, uu_uu_ud, uu_uu_dd, uu_ud_ud, uu_ud_dd, uu_dd_dd, ud_ud_ud, ud_ud_dd, ud_dd_dd, dd_dd_dd)</span>

<span class="sd">        see also libxc_itrf.c</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">hyb</span><span class="p">,</span> <span class="n">fn_facs</span> <span class="o">=</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_eval_xc</span><span class="p">(</span><span class="n">fn_facs</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">spin</span><span class="p">,</span> <span class="n">relativity</span><span class="p">,</span> <span class="n">deriv</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span></div>


<span class="n">SINGULAR_IDS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="mi">131</span><span class="p">,</span>  <span class="c1"># LYP functions</span>
                    <span class="mi">402</span><span class="p">,</span> <span class="mi">404</span><span class="p">,</span> <span class="mi">411</span><span class="p">,</span> <span class="mi">416</span><span class="p">,</span> <span class="mi">419</span><span class="p">,</span>   <span class="c1"># hybrid LYP functions</span>
                    <span class="mi">74</span> <span class="p">,</span> <span class="mi">75</span> <span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">227</span><span class="p">))</span>       <span class="c1"># M11L and MN12L functional</span>
<span class="k">def</span> <span class="nf">_eval_xc</span><span class="p">(</span><span class="n">fn_facs</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relativity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">deriv</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">nspin</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">rho_u</span> <span class="o">=</span> <span class="n">rho_d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nspin</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">rho_u</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
        <span class="n">rho_d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">rho_u</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">numpy</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">rho_d</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">numpy</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">rho_u</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">rho_u</span> <span class="o">=</span> <span class="n">rho_u</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">rho_d</span> <span class="o">=</span> <span class="n">rho_d</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ngrids</span> <span class="o">=</span> <span class="n">rho_u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">fn_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fn_facs</span><span class="p">]</span>
    <span class="n">facs</span>   <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fn_facs</span><span class="p">]</span>
    <span class="n">fn_ids_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">fn_ids</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fn_ids_set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">PROBLEMATIC_XC</span><span class="p">):</span>
        <span class="n">problem_xc</span> <span class="o">=</span> <span class="p">[</span><span class="n">PROBLEMATIC_XC</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                      <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fn_ids_set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">PROBLEMATIC_XC</span><span class="p">)]</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Libxc functionals </span><span class="si">%s</span><span class="s1"> have large discrepancy to xcfun &#39;</span>
                      <span class="s1">&#39;library.</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">problem_xc</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fn_ids</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span>  <span class="c1"># xc_code = &#39;&#39; or xc_code = &#39;HF&#39;, an empty functional</span>
        <span class="nb">all</span><span class="p">((</span><span class="n">is_lda</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fn_ids</span><span class="p">))):</span>
        <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">nvar</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nvar</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="nb">any</span><span class="p">((</span><span class="n">is_meta_gga</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fn_ids</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">nvar</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nvar</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># GGA</span>
        <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">nvar</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nvar</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">outlen</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">nvar</span><span class="o">+</span><span class="n">deriv</span><span class="p">)</span> <span class="o">//</span>
              <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">nvar</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">deriv</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">SINGULAR_IDS</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">fn_ids_set</span><span class="p">)</span> <span class="ow">and</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">non0idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho_u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1e-10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rho_d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1e-10</span><span class="p">)</span>
        <span class="n">rho_u</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rho_u</span><span class="p">[:,</span><span class="n">non0idx</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
        <span class="n">rho_d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rho_d</span><span class="p">[:,</span><span class="n">non0idx</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
        <span class="n">outbuf</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">outlen</span><span class="p">,</span><span class="n">non0idx</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">outbuf</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">outlen</span><span class="p">,</span><span class="n">ngrids</span><span class="p">))</span>

    <span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_eval_xc</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">n</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="o">*</span><span class="n">n</span><span class="p">)(</span><span class="o">*</span><span class="n">fn_ids</span><span class="p">),</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="o">*</span><span class="n">n</span><span class="p">)(</span><span class="o">*</span><span class="n">facs</span><span class="p">),</span>
                        <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">nspin</span><span class="p">),</span>
                        <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">deriv</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">rho_u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                        <span class="n">rho_u</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">),</span>
                        <span class="n">rho_d</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">),</span>
                        <span class="n">outbuf</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">outbuf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ngrids</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">outlen</span><span class="p">,</span><span class="n">ngrids</span><span class="p">))</span>
        <span class="n">out</span><span class="p">[:,</span><span class="n">non0idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">outbuf</span>
        <span class="n">outbuf</span> <span class="o">=</span> <span class="n">out</span>

    <span class="n">exc</span> <span class="o">=</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">vxc</span> <span class="o">=</span> <span class="n">fxc</span> <span class="o">=</span> <span class="n">kxc</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">nvar</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># LDA</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">vxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">2</span><span class="p">],)</span> <span class="o">+</span> <span class="p">(</span><span class="kc">None</span><span class="p">,)</span><span class="o">*</span><span class="mi">9</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">kxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">nvar</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># GGA</span>
            <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">vxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">fxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">5</span><span class="p">],)</span> <span class="o">+</span> <span class="p">(</span><span class="kc">None</span><span class="p">,)</span><span class="o">*</span><span class="mi">7</span>
            <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">kxc</span> <span class="o">=</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># LDA</span>
            <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">vxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">fxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="kc">None</span><span class="p">,)</span><span class="o">*</span><span class="mi">9</span>
            <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">kxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">nvar</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>  <span class="c1"># GGA</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">vxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">15</span><span class="p">:</span><span class="mi">21</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="kc">None</span><span class="p">,)</span><span class="o">*</span><span class="mi">7</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">kxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">21</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">25</span><span class="p">:</span><span class="mi">34</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">34</span><span class="p">:</span><span class="mi">46</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">46</span><span class="p">:</span><span class="mi">56</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">nvar</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>  <span class="c1"># MGGA</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">vxc</span> <span class="o">=</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fxc</span> <span class="o">=</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">kxc</span> <span class="o">=</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">15</span><span class="p">:</span><span class="mi">19</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">nvar</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>  <span class="c1"># MGGA</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">vxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">13</span><span class="p">:</span><span class="mi">19</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                   <span class="n">outbuf</span><span class="p">[</span><span class="mi">25</span><span class="p">:</span><span class="mi">28</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">28</span><span class="p">:</span><span class="mi">31</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">31</span><span class="p">:</span><span class="mi">35</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                   <span class="n">outbuf</span><span class="p">[</span><span class="mi">35</span><span class="p">:</span><span class="mi">39</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">39</span><span class="p">:</span><span class="mi">43</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">43</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                   <span class="n">outbuf</span><span class="p">[</span><span class="mi">49</span><span class="p">:</span><span class="mi">55</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span><span class="p">,</span> <span class="n">fxc</span><span class="p">,</span> <span class="n">kxc</span>


<div class="viewcode-block" id="define_xc_"><a class="viewcode-back" href="../../../dft.html#pyscf.dft.libxc.define_xc_">[docs]</a><span class="k">def</span> <span class="nf">define_xc_</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">xctype</span><span class="o">=</span><span class="s1">&#39;LDA&#39;</span><span class="p">,</span> <span class="n">hyb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rsh</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)):</span>
    <span class="sd">&#39;&#39;&#39;Define XC functional.  See also :func:`eval_xc` for the rules of input description.</span>

<span class="sd">    Args:</span>
<span class="sd">        ni : an instance of :class:`NumInt`</span>

<span class="sd">        description : str</span>
<span class="sd">            A string to describe the linear combination of different XC functionals.</span>
<span class="sd">            The X and C functional are separated by comma like &#39;.8*LDA+.2*B86,VWN&#39;.</span>
<span class="sd">            If &quot;HF&quot; was appeared in the string, it stands for the exact exchange.</span>

<span class="sd">    Kwargs:</span>
<span class="sd">        xctype : str</span>
<span class="sd">            &#39;LDA&#39; or &#39;GGA&#39; or &#39;MGGA&#39;</span>
<span class="sd">        hyb : float</span>
<span class="sd">            hybrid functional coefficient</span>
<span class="sd">        rsh : float</span>
<span class="sd">            coefficients for range-separated hybrid functional</span>

<span class="sd">    Examples:</span>

<span class="sd">    &gt;&gt;&gt; mol = gto.M(atom=&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;, basis=&#39;ccpvdz&#39;)</span>
<span class="sd">    &gt;&gt;&gt; mf = dft.RKS(mol)</span>
<span class="sd">    &gt;&gt;&gt; define_xc_(mf._numint, &#39;.2*HF + .08*LDA + .72*B88, .81*LYP + .19*VWN&#39;)</span>
<span class="sd">    &gt;&gt;&gt; mf.kernel()</span>
<span class="sd">    -76.3783361189611</span>
<span class="sd">    &gt;&gt;&gt; define_xc_(mf._numint, &#39;LDA*.08 + .72*B88 + .2*HF, .81*LYP + .19*VWN&#39;)</span>
<span class="sd">    &gt;&gt;&gt; mf.kernel()</span>
<span class="sd">    -76.3783361189611</span>
<span class="sd">    &gt;&gt;&gt; def eval_xc(xc_code, rho, *args, **kwargs):</span>
<span class="sd">    ...     exc = 0.01 * rho**2</span>
<span class="sd">    ...     vrho = 0.01 * 2 * rho</span>
<span class="sd">    ...     vxc = (vrho, None, None, None)</span>
<span class="sd">    ...     fxc = None  # 2nd order functional derivative</span>
<span class="sd">    ...     kxc = None  # 3rd order functional derivative</span>
<span class="sd">    ...     return exc, vxc, fxc, kxc</span>
<span class="sd">    &gt;&gt;&gt; define_xc_(mf._numint, eval_xc, xctype=&#39;LDA&#39;)</span>
<span class="sd">    &gt;&gt;&gt; mf.kernel()</span>
<span class="sd">    48.8525211046668</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">ni</span><span class="o">.</span><span class="n">eval_xc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xc_code</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> \
                <span class="n">eval_xc</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ni</span><span class="o">.</span><span class="n">hybrid_coeff</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">hybrid_coeff</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
        <span class="n">ni</span><span class="o">.</span><span class="n">rsh_coeff</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">rsh_coeff</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
        <span class="n">ni</span><span class="o">.</span><span class="n">_xc_type</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">xc_type</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">description</span><span class="p">):</span>
        <span class="n">ni</span><span class="o">.</span><span class="n">eval_xc</span> <span class="o">=</span> <span class="n">description</span>
        <span class="n">ni</span><span class="o">.</span><span class="n">hybrid_coeff</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">hyb</span>
        <span class="n">ni</span><span class="o">.</span><span class="n">rsh_coeff</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">rsh</span>
        <span class="n">ni</span><span class="o">.</span><span class="n">_xc_type</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">xctype</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown description </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">description</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ni</span></div>

<div class="viewcode-block" id="define_xc"><a class="viewcode-back" href="../../../dft.html#pyscf.dft.libxc.define_xc">[docs]</a><span class="k">def</span> <span class="nf">define_xc</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">xctype</span><span class="o">=</span><span class="s1">&#39;LDA&#39;</span><span class="p">,</span> <span class="n">hyb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rsh</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)):</span>
    <span class="k">return</span> <span class="n">define_xc_</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ni</span><span class="p">),</span> <span class="n">description</span><span class="p">,</span> <span class="n">xctype</span><span class="p">,</span> <span class="n">hyb</span><span class="p">,</span> <span class="n">rsh</span><span class="p">)</span></div>
<span class="n">define_xc</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">define_xc_</span><span class="o">.</span><span class="vm">__doc__</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
        <span class="n">atom</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;O&quot;</span> <span class="p">,</span> <span class="p">(</span><span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.</span>     <span class="p">,</span> <span class="mf">0.</span><span class="p">)],</span>
        <span class="p">[</span><span class="mi">1</span>   <span class="p">,</span> <span class="p">(</span><span class="mf">0.</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.757</span> <span class="p">,</span> <span class="mf">0.587</span><span class="p">)],</span>
        <span class="p">[</span><span class="mi">1</span>   <span class="p">,</span> <span class="p">(</span><span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.757</span>  <span class="p">,</span> <span class="mf">0.587</span><span class="p">)]</span> <span class="p">],</span>
        <span class="p">)</span>
    <span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="c1">#mf._numint.libxc = dft.xcfun</span>
    <span class="n">mf</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">&#39;camb3lyp&#39;</span>
    <span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
    <span class="n">mf</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">&#39;b88,lyp&#39;</span>
    <span class="n">eref</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

    <span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">mf</span><span class="o">.</span><span class="n">_numint</span> <span class="o">=</span> <span class="n">define_xc</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="s1">&#39;BLYP&#39;</span><span class="p">)</span>
    <span class="n">e1</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e1</span> <span class="o">-</span> <span class="n">eref</span><span class="p">)</span>

    <span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">mf</span><span class="o">.</span><span class="n">_numint</span> <span class="o">=</span> <span class="n">define_xc</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="s1">&#39;B3LYP5&#39;</span><span class="p">)</span>
    <span class="n">e1</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e1</span> <span class="o">-</span> <span class="o">-</span><span class="mf">75.2753037898599</span><span class="p">)</span>
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-, Qiming Sun &lt;osirpt.sun@gmail.com&gt;.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.5.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: ''
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>